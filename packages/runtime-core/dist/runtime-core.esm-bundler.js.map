{
  "version": 3,
  "sources": ["../../shared/src/makeMap.ts", "../../shared/src/general.ts", "../src/errorHandling.ts", "../src/componentPublicInstance.ts", "../src/components.ts", "../src/vnode.ts", "../src/componentRenderUtils.ts", "../../reactivity/src/dep.ts", "../../reactivity/src/effectScope.ts", "../../reactivity/src/effect.ts", "../../reactivity/src/ref.ts", "../../reactivity/src/baseHandlers.ts", "../../reactivity/src/reactive.ts", "../src/renderer.ts", "../src/h.ts", "../../runtime-dom/src/nodeOps.ts", "../../runtime-dom/src/modules/class.ts", "../../runtime-dom/src/modules/style.ts", "../../runtime-dom/src/modules/events.ts", "../../runtime-dom/src/modules/attrs.ts", "../../runtime-dom/src/patchProp.ts", "../../runtime-dom/src/index.ts"],
  "sourcesContent": ["export function makeMap(str: string): (key: string) => boolean {\n\tconst map: Record<string, boolean> = Object.create(null);\n\tconst strs = str.split(',');\n\tfor (let i = 0; i < strs.length; i++) {\n\t\tmap[strs[i]] = true;\n\t}\n\treturn val => !!map[val];\n}\n", "import { makeMap } from './makeMap';\n\nexport const isObject = (val: unknown): val is Record<any, any> => val !== null && typeof val === 'object';\n\nexport const hasChanged = (value: any, oldValue: any): boolean => !Object.is(value, oldValue);\n\nexport const isFunction = (val: unknown): val is Function => typeof val === 'function';\n\nexport const NOOP = () => {};\n\nexport const NO = () => false;\n\nexport const isArray = Array.isArray;\nexport const isMap = (val: unknown): val is Map<any, any> => toTypeString(val) === '[object Map]';\nexport const isSet = (val: unknown): val is Set<any> => toTypeString(val) === '[object Set]';\nexport const isString = (val: unknown): val is String => typeof val === 'string';\n\nexport const objectToString = Object.prototype.toString;\nexport const toTypeString = (value: unknown): string => objectToString.call(value);\n\nexport const isPlainObject = (val: unknown): val is object => toTypeString(val) === '[object Object]';\n\nexport const isNoEmptyValue = (val: unknown) => val !== undefined || val !== null;\n\nexport const extend = Object.assign;\n\nexport const EMPTY_OBJ: { readonly [key: string]: any } = {};\n\n// \u4E8B\u4EF6 onXxxx \u6216\u8005\u4E5F\u53EF\u4EE5\u8FD9\u4E48\u5199\uFF1A /^on[A-Z]/\nexport const onRE = /^on[^a-z]/;\n\nexport const isOn = (key: string) => onRE.test(key);\n\n// \u4E0B\u9762\u8FD9\u4E9Bkey\u662Fvue\u5185\u90E8\u4FDD\u7559\u7684\u5173\u952E\u5B57\uFF0C\u5143\u7D20\u81EA\u5B9A\u4E49\u5C5E\u6027props\u4E00\u822C\u4E0D\u5141\u8BB8\u7528\u4E0B\u9762\u7684key, \u7A7A\u5B57\u7B26\u4E32\u4E5F\u7B97\n// [\"\", \"key\", \"ref\"]\nexport const isReservedProp = makeMap(',key,ref');\n\nexport const hasOwn = (val: object, key: string): key is keyof typeof val =>\n\tObject.prototype.hasOwnProperty.call(val, key);\n", "// \u6846\u67B6\u7EDF\u4E00error\u5904\u7406\n\nexport function callWithErrorHandling(fn: Function, args?: unknown[]) {\n\tlet res;\n\ttry {\n\t\tres = args ? fn(...args) : fn();\n\t} catch (err) {\n\t\t// \u53EF\u4EE5\u7EDF\u4E00\u9519\u8BEF\u4FE1\u606F\n\t\tconsole.log(err);\n\t}\n\treturn res;\n}\n", "import { EMPTY_OBJ, hasOwn, isFunction } from '@vue/shared';\nimport { ComponentRenderContext } from './components';\n\nconst enum AccessTypes {\n\tOTHER,\n\tSETUP,\n\tDATA,\n\tPROPS,\n\tCONTEXT\n}\n\nexport const PublicInstanceProxyHandlers: ProxyHandler<any> = {\n\tget({ _: instance }: ComponentRenderContext, key: string) {\n\t\tlet data = instance.data;\n\t\tconst { accessCache, type } = instance;\n\n\t\t// \u8FD9\u91CC\u8DDF\u6E90\u7801\u4E0D\u4E00\u81F4\uFF0C\u505A\u4E86\u7B80\u5316\u5904\u7406\uFF0C\u517C\u5BB9\u4E0Bvue2\u5199\u6CD5\n\t\t/**\n\t\t *\n\t\t * const component = {\n\t\t * \t\tdata() {\n\t\t * \t\t\treturn {name: 'vue'}\n\t\t * \t  },\n\t\t *\n\t\t * \t\trender() {\n\t\t * \t\t\treturn h('div', `${this.name}`)\n\t\t * \t\t}\n\t\t *\n\t\t * }\n\t\t *\n\t\t */\n\t\tif (type.data && isFunction(type.data)) {\n\t\t\tdata = type.data();\n\t\t}\n\n\t\t// \u83B7\u53D6data\u51FD\u6570\u4E2D\u7684\u503C\n\t\tif (data !== EMPTY_OBJ && hasOwn(data, key)) {\n\t\t\t// \u7F13\u5B58\n\t\t\taccessCache[key] = AccessTypes.DATA;\n\t\t\treturn data[key];\n\t\t}\n\t}\n};\n", "// \u54B1\u7528any\u9876\u4E00\u4E0B\n\nimport { EMPTY_OBJ, NOOP, ShapeFlags, isFunction, isObject } from '@vue/shared';\nimport { ComponentInternalInstance, InternalRenderFunction } from './componentRenderUtils';\nimport { VNode } from './vnode';\nimport { callWithErrorHandling } from './errorHandling';\nimport { PublicInstanceProxyHandlers } from './componentPublicInstance';\n\nexport type Component = any;\n\nexport interface ComponentRenderContext {\n\t_: ComponentInternalInstance;\n}\n\n// \u81EA\u589E\u7684\u7EC4\u4EF6\u6807\u8BC6\u7B26\nlet uid = 0;\n\n// \u521B\u5EFA\u7EC4\u4EF7\u5B9E\u4F8B\nexport function createComponentInstance(\n\tvnode: VNode,\n\tparent: ComponentInternalInstance | null\n): ComponentInternalInstance {\n\tconst instance: ComponentInternalInstance = {\n\t\tvnode,\n\t\tparent,\n\t\troot: null,\n\t\ttype: vnode.type,\n\t\tuid: uid++,\n\n\t\tdata: EMPTY_OBJ,\n\t\tprops: EMPTY_OBJ,\n\t\tattrs: EMPTY_OBJ,\n\t\tslots: EMPTY_OBJ,\n\t\trefs: EMPTY_OBJ,\n\t\tsetupState: EMPTY_OBJ,\n\t\tctx: EMPTY_OBJ,\n\n\t\taccessCache: EMPTY_OBJ,\n\n\t\temit: null,\n\n\t\tproxy: null,\n\t\tupdate: null,\n\n\t\trender: null,\n\n\t\tsubTree: null,\n\n\t\teffect: null,\n\n\t\tisMounted: false\n\t};\n\n\tinstance.ctx = { _: instance };\n\tinstance.root = parent ? parent.root : instance;\n\n\treturn instance;\n}\n\nexport function isStatefulComponent(instance: ComponentInternalInstance) {\n\treturn instance.vnode.shapeFlag & ShapeFlags.STATEFUL_COMPONENT;\n}\n\nexport function setupComponent(instance: ComponentInternalInstance) {\n\t//TODO: props slots\n\n\tconst isStateful = isStatefulComponent(instance);\n\n\tconst setupResult = isStateful ? setupStatefulComponent(instance) : null;\n\treturn setupResult;\n}\n\nexport function setupStatefulComponent(instance: ComponentInternalInstance) {\n\tconst Component = instance.type;\n\n\tinstance.proxy = new Proxy(instance.ctx, PublicInstanceProxyHandlers);\n\n\t// vue3 setup\n\tconst { setup } = Component;\n\n\tif (setup) {\n\t\tconst setupResult = callWithErrorHandling(setup);\n\n\t\thandleSetupResult(instance, setupResult);\n\n\t\t// \u5148\u4E0D\u8003\u8651async setup\n\t} else {\n\t\tfinishComponentSetup(instance);\n\t}\n}\n\n// \u5904\u7406setup \u8FD4\u56DE\u7684\u503C\nexport function handleSetupResult(instance: ComponentInternalInstance, setupResult: unknown) {\n\t// functional component\n\tif (isFunction(setupResult)) {\n\t\tinstance.render = setupResult as InternalRenderFunction;\n\t} else if (isObject(setupResult)) {\n\t\t// setup\u51FD\u6570\u8FD4\u56DE\u7684\u662F\u666E\u901A\u5BF9\u8C61 {}\n\t\t// TODO:\n\t}\n\tfinishComponentSetup(instance);\n}\n\n// \u4E13\u95E8\u5904\u7406render\nexport function finishComponentSetup(instance: ComponentInternalInstance) {\n\tconst Component = instance.type;\n\t// \u5904\u7406render\n\tif (!instance.render) {\n\t\t// \u62FF\u5230render\u51FD\u6570\n\t\tinstance.render = (Component.render || NOOP) as InternalRenderFunction;\n\t}\n}\n", "import { Ref } from '@vue/reactivity';\nimport { ShapeFlags, isArray, isFunction, isObject, isString } from '@vue/shared';\nimport { RendererNode } from './renderer';\nimport { Component } from './components';\n\n// ref='xxx'\n// ref=\"ref('xxx)\"\n// ref=\"(ref('xxx' | toRefs(reactive))) => void\"\nexport type VNodeRef = string | Ref | ((ref: Element | null, refs: Record<string, any>) => void);\n\nexport type VNodeProps = {\n\tkey?: string | number | symbol;\n\tref?: VNodeRef;\n};\n\n/**\u5360\u4F4D */\nexport const Fragment = Symbol.for('v-fgt') as any as {\n\t__isFragment: true;\n\tnew (): {\n\t\t$props: VNodeProps;\n\t};\n};\n/**\u7EAF\u6587\u672C */\nexport const Text = Symbol.for('v-txt');\n/**\u6CE8\u91CA\u8282\u70B9 */\nexport const Comment = Symbol.for('v-cmt');\n\n/**\u865A\u62DFnode\u7684\u7C7B\u578B\uFF0C\u6587\u672C \u6216\u8005\u662Fnode */\nexport type VNodeTypes = string | VNode | Component | typeof Text | typeof Comment | typeof Fragment;\n\nexport type Data = Record<string, unknown>;\n\ntype VNodeChildAtom = VNode | string | number | boolean | null | undefined | void;\n\nexport type VNodeChild = VNodeChildAtom | VNodeArrayChildren;\n\nexport type VNodeArrayChildren = Array<VNodeChild>;\n\nexport type VNodeNormalizedChildren = string | VNodeArrayChildren | null;\n\nexport function isVNode(value: any): value is VNode {\n\treturn value ? value.__v_isVNode === true : false;\n}\n\nexport interface VNode<HostNode = RendererNode, ExtraProps = { [key: string]: any }> {\n\t/**\n\t * vnode\u6807\u8BC6\n\t */\n\t__v_isVNode: true;\n\n\t/**\n\t * vnode\u81EA\u5DF1\u7684\u7C7B\u578B\n\t */\n\ttype: VNodeTypes;\n\t/**\n\t * \u5C5E\u6027\n\t */\n\tprops: (VNodeProps & ExtraProps) | null;\n\t/**\n\t * \u5FAA\u73AF\u53D8\u91CF\uFF0C\u6307\u5B9A\u7684key\n\t */\n\tkey: string | number | symbol | null;\n\n\tref: VNodeRef | null;\n\n\t/**\n\t * \u5B69\u5B50\uFF0C\u5B69\u5B50\u7684\u7C7B\u578B\u53EF\u4EE5\u662F \u7A7A\u3001\u6587\u672C\u3001node\uFF0C\u4EE5\u53CA\u6570\u636E[\u6587\u672C]\u3001\u6570\u7EC4[node]\n\t */\n\tchildren: VNodeNormalizedChildren | null;\n\n\t// DOM\n\n\t/**\n\t * \u6620\u5C04\u7684\u771F\u5B9E\u8282\u70B9\n\t */\n\tel: HostNode | null;\n\t/**\n\t * \u5BF9\u5E94\u7684\u4F4D\u7F6E\n\t */\n\tanchor: HostNode | null; // fragment anchor\n\n\t/**node\u5143\u7D20\u7C7B\u578Bflag */\n\t/**\u6807\u8BB0\u81EA\u5DF1\u662F\u4EC0\u4E48\u7C7B\u578B\u548C\u5B69\u5B50\u662F\u4EC0\u4E48\u7C7B\u578B */\n\tshapeFlag: number;\n}\n\n/**\u5904\u7406key */\nconst normalizeKey = ({ key }: VNodeProps): VNode['key'] => (key != null ? key : null);\n\nconst normalizeRef = ({ ref }: VNodeProps): VNode['ref'] => {\n\tif (typeof ref === 'number') {\n\t\tref = String(ref);\n\t}\n\treturn ref;\n};\n/**\n * \u521B\u5EFA\u865A\u62DFdom\uFF0C\u53EF\u80FD\u662F\u6587\u672C\u3001div\u666E\u901A\u5143\u7D20\u3001\u81EA\u5B9A\u4E49\u7EC4\u4EF6\u3001\u6CE8\u91CA\u3001Fragment\u3001\u9759\u6001\u8282\u70B9\u3001Teleport\u3001Suspense\n */\nexport function createVNode(\n\ttype: VNodeTypes,\n\tprops: (VNodeProps & Data) | null = null,\n\tchildren: unknown = null\n): VNode {\n\t// \u6E90\u7801\u91CC\u9762\uFF1A\n\t// type: \u5982\u679C\u662FVNode \u9700\u8981cloneVNode\n\t// eg. :class=\"{a: xx, b: xxx}\" :class=\"['classA', {'classB': true }]\"\n\t// eg. :style=\"{'display': 'flex'}\" :style=\"[{'display': 'flex'}, { 'flex': 2 }]\"\n\t// props\u91CC\u9762\u5982\u679C\u6709class\u3001style \u4E5F\u9700\u8981\u62CD\u5E73\u5904\u7406\n\t// \u8FD9\u91CC\u4E3A\u4E86\u7B80\u4FBF\uFF1A\u5C31\u4E0D\u5904\u7406\u4E86\n\n\t// eg. h('div')  h('div', { props })  h('div', { props }, children)\n\t// \u5982\u679C\u6709\u503C\uFF0C\u4E00\u5B9A\u662F\u5143\u7D20\u7C7B\u578B\n\t// \u5982\u679C\u662F\u5BF9\u8C61\uFF0C\u5219\u4E3A\u7EC4\u4EF6\u7C7B\u578B\n\tconst shapeFlag = isString(type)\n\t\t? ShapeFlags.ELEMENT\n\t\t: isObject(type)\n\t\t? ShapeFlags.STATEFUL_COMPONENT\n\t\t: isFunction(type)\n\t\t? ShapeFlags.FUNCTIONAL_COMPONENT\n\t\t: 0;\n\n\treturn createBaseVNode(type, props, children, shapeFlag);\n}\n\nfunction createBaseVNode(\n\ttype: VNodeTypes,\n\tprops: (VNodeProps & Data) | null = null,\n\tchildren: any = null,\n\tshapeFlag = type === Fragment ? 0 : ShapeFlags.ELEMENT\n): VNode {\n\tconst vnode: VNode = {\n\t\t__v_isVNode: true,\n\t\ttype,\n\t\tprops,\n\t\tkey: props && normalizeKey(props),\n\t\tref: props && normalizeRef(props),\n\t\tchildren,\n\t\tel: null, // \u771F\u5B9E\u8282\u70B9 \u521D\u59CB\u5316\u4E3Anull\n\t\tanchor: null,\n\t\tshapeFlag\n\t};\n\t// \u5904\u7406\u5B50\u7C7B\u578B\u548C\u81EA\u5DF1\u7684\u7C7B\u578B\n\tif (children) {\n\t\t// h('div', props, 'xxx') \u6E32\u67D3\u4E3A <div ...props>xxx</div>\n\t\t// h('div', props, [h('span', props, 'yyyy')]) \u6E32\u67D3\u4E3A <div ...props><span ...props>yyyy</span></div>\n\n\t\tvnode.shapeFlag |= isString(children) ? ShapeFlags.TEXT_CHILDREN : ShapeFlags.ARRAY_CHILDREN;\n\t}\n\treturn vnode;\n}\n\n// \u5224\u65AD\u662F\u5426\u662F\u540C\u4E00\u4E2A\u865A\u62DF\u8282\u70B9\uFF0C \u56E0\u4E3A\u6BCF\u4E2A\u865A\u62DF\u8282\u70B9\u7684type\u548Ckey\u90FD\u662F\u552F\u4E00\u7684\nexport function isSameVNodeType(n1: VNode, n2: VNode) {\n\treturn n1.type === n2.type && n1.key === n2.key;\n}\n\n// eg. h('div', props, h('span', props))  h('div', props, [h('span', props)])\n// \u5904\u7406child \u8F6C\u51FAvnode\nexport function normalizeVNode(child: VNodeChild): VNode {\n\tif (child === null || typeof child === 'boolean') {\n\t\t// \u6CE8\u91CA\u8282\u70B9\n\t\treturn createVNode(Comment);\n\t} else if (isArray(child)) {\n\t\t// \u6570\u7EC4\u7684\u8BDD \u7236\u5143\u7D20\u5F04\u4E2A\u7A7A\u7684\u5360\u4F4D\u7B26\uFF1AFragment\uFF0Cchild copy\u4E00\u4EFD\n\t\treturn createVNode(Fragment, null, child.slice());\n\t} else if (typeof child === 'object') {\n\t\t// \u672C\u8EAB\u5C31\u662F vnode\n\t\t// TODO: cloneVNode\n\t\treturn CloneVNode(child);\n\t} else {\n\t\t// string numbers\n\t\treturn createVNode(Text, null, String(child));\n\t}\n}\n\n// TODO:\u5B9E\u73B0\nexport function CloneVNode(vnode: VNode): VNode {\n\treturn vnode;\n}\n", "import { ReactiveEffect, WatchOptions } from '@vue/reactivity';\nimport { VNode, VNodeChild, createVNode, normalizeVNode } from './vnode';\nimport { SchedulerJob } from './scheduler';\nimport { ShapeFlags } from '@vue/shared';\n\nexport type Data = Record<string, unknown>;\n\nexport type InternalRenderFunction = {\n\t(\n\t\tctx: ComponentPublicInstance,\n\n\t\t$props: ComponentInternalInstance['props'],\n\t\t$setup: ComponentInternalInstance['setupState'],\n\t\t$data: ComponentInternalInstance['data'],\n\t\t$options: ComponentInternalInstance['ctx']\n\t): VNodeChild;\n};\n\n// \u7EC4\u4EF6\u5916\u90E8\u5B9E\u4F8B -> \u7528\u6237\u53EF\u4EE5\u76F4\u63A5\u4F7F\u7528\u7684\u5C5E\u6027\nexport type ComponentPublicInstance<Props = {}, Data = {}> = {\n\t// $\u6307\u5411\u5185\u90E8\u7EC4\u4EF6\u5B9E\u4F8B\n\t$: ComponentInternalInstance;\n\n\t// \u72B6\u6001 props \u76F8\u5173\n\t$props: Props;\n\t$data: Data;\n\t$arrts: Data;\n\t$refs: Data;\n\t$slots: any;\n\n\t$options: Data;\n\n\t// \u5143\u7D20\u76F8\u5173\n\t$el: any;\n\t// root\n\t$root: ComponentPublicInstance;\n\t// \u7236\u5143\u7D20\n\t$parent: ComponentPublicInstance;\n\n\t// watch update emit\n\t$watch: (source: any, cb: () => any, options: WatchOptions) => any;\n\t$emit: () => void;\n\t$forceUpdate: () => void;\n\t$nextTick: () => void;\n};\n\n// \u7EC4\u4EF6\u5185\u90E8\u5B9E\u4F8B -> \u6846\u67B6\u5F00\u53D1\u7528\nexport interface ComponentInternalInstance {\n\tuid: number;\n\n\t// \u533A\u5206\u7EC4\u4EF6\u7C7B\u578B\u3001\u72B6\u6001\u7EC4\u4EF6 \u8FD8\u662F\u51FD\u6570\u7EC4\u4EF6\n\ttype: any;\n\n\t// \u7236\u7EC4\u4EF6\n\tparent: ComponentInternalInstance | null;\n\t// \u6839\u7EC4\u4EF6\n\troot: ComponentInternalInstance;\n\n\t// state\n\t// \u6700\u5E38\u7528\u7684\u51E0\u4E2A\n\tdata: Data;\n\tprops: Data;\n\tattrs: Data;\n\tslots: any;\n\trefs: Data;\n\n\t// \u7F13\u5B58\n\taccessCache: Data | null;\n\temit: () => void;\n\n\t// \u5176\u5B9E\u5C31\u662F\u5F53\u524D\u7EC4\u4EF6 this\n\tproxy: ComponentPublicInstance | null;\n\n\tsetupState: Data;\n\n\tctx: Data;\n\n\trender: InternalRenderFunction | null;\n\n\t// \u7EC4\u4EF6\u5F3A\u5236\u66F4\u65B0\u7684\u65B9\u6CD5\n\t// \u6267\u884C\u5C31\u662F effect.run \u65B9\u6CD5\n\tupdate: SchedulerJob | null;\n\n\t// \u81EA\u5DF1\u5728\u7236\u7EC4\u4EF6\u7684vnode\n\tvnode: VNode;\n\n\t// \u81EA\u5DF1\u7684vnode\n\tsubTree: VNode;\n\n\t// \u7EC4\u4EF6\u5C31\u662F\u4E00\u4E2Aeffect\n\teffect: ReactiveEffect;\n\n\t// TODO: lifeCycle\n\tisMounted: boolean;\n}\n\nexport function renderComponentRoot(instance: ComponentInternalInstance): VNode {\n\tconst { type: Component, vnode, props, data, ctx, attrs, slots, emit, setupState, proxy, render } = instance;\n\tconst { shapeFlag } = vnode;\n\t// \u5224\u65AD\u662F\u72B6\u6001\u7EC4\u4EF6\u8FD8\u662F\u51FD\u6570\u7EC4\u4EF6\n\tlet result: VNode;\n\ttry {\n\t\tif (shapeFlag & ShapeFlags.STATEFUL_COMPONENT) {\n\t\t\t// \u6267\u884C\u7EC4\u4EF6\u7684render\u51FD\u6570\uFF0C\u62FF\u5230vnode\uFF0C\n\t\t\t// \u540C\u65F6\u7ED1\u5B9A\u54CD\u5E94\u5F0F\u6570\u636E\uFF0C\u56E0\u4E3A\u5728\u6A21\u677F\u4E2D\u4F1A\u8BBF\u95EEthis\u3001props\u3001state\u7B49\u54CD\u5E94\u5F0F\u6570\u636E\n\n\t\t\tresult = normalizeVNode(render!.call(proxy, props, setupState, data, ctx));\n\t\t} else if (shapeFlag & ShapeFlags.FUNCTIONAL_COMPONENT) {\n\t\t\t// \u51FD\u6570\u7EC4\u4EF6\n\t\t\tlet render = Component;\n\t\t\tresult = normalizeVNode(render.length > 1 ? render(props, { attrs, slots, emit }) : render(props, null));\n\t\t}\n\t} catch (error) {\n\t\t// \u5982\u679C\u9519\u8BEF\uFF0C\u7528\u6CE8\u91CA\u8282\u70B9Comment \u6765\u515C\u5E95\uFF1F\uFF1F\uFF1F\u4E3A\u4EC0\u4E48\n\t\tresult = createVNode(Comment);\n\t}\n\n\treturn result;\n}\n", "import { ReactiveEffect } from './effect';\n\nexport type Dep = Set<ReactiveEffect>;\n\nexport const createDep = (effects?: ReactiveEffect[]): Dep => {\n\tconst dep = new Set<ReactiveEffect>(effects) as Dep;\n\treturn dep;\n};\n", "import { ReactiveEffect } from './effect';\n\nlet activeEffectScope: EffectScope | undefined;\n\ninterface EffectScope {\n\trun<T>(fn: () => T): T | undefined; // \u5982\u679C\u4F5C\u7528\u57DF\u4E0D\u6D3B\u8DC3\u5C31\u4E3A undefined\n\tstop(): void;\n}\n\n// EffectScope \u5B9E\u73B0\u65B9\u5F0F\u8DDFeffect\u4E00\u6837\u7684\u9053\u7406\uFF0Cscope\u5185\u90E8\u7684effect\u6536\u96C6\u5F53\u524D\u6B63\u5728\u6267\u884CeffectScope\u4F5C\u7528\u57DF\n\n/**\n * @example\n * ```js\n \t\t\tconst scope = effectScope();\n\t\t\tscope.run(() => {\n\t\t\t\tconst state = reactive({ name: 'xxx' });\n\n\t\t\t\t// \u5185\u90E8\u6536\u96C6\u4E86effect\uFF0C \u5F53\u8C03\u7528scope.stop\u65F6\uFF0C\u5176\u5185\u90E8\u4F1A\u628A\u6536\u96C6\u5230effect\u5168\u90E8stop\n\t\t\t\teffect(() => {\n\t\t\t\t\tconsole.log(state.name);\n\t\t\t\t});\n\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tstate.name = 'kkkk';\n\t\t\t\t}, 1000);\n\n\t\t\t\tconst scope2 = effectScope();\n\t\t\t\tscope2.run(() => {\n\t\t\t\t\tconst state = reactive({ age: 10 });\n\n\t\t\t\t\teffect(() => console.log(state.age));\n\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tstate.age++;\n\t\t\t\t\t}, 1000);\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tscope.stop();\n * ```\n */\n\nclass EffectScope {\n\t// \u6807\u8BB0\u662F\u5426\u662F\u6FC0\u6D3B\u72B6\u6001\n\tprivate _active = true;\n\n\t// \u8BB0\u5F55\u6536\u96C6\u5230\u7684effect\n\teffects: ReactiveEffect[];\n\n\tparent: EffectScope;\n\n\tcleanups: (() => void)[];\n\n\t// \u8BB0\u5F55\u5185\u90E8\u7684\u6240\u6709\u4F5C\u7528\u57DF\n\tscopes: EffectScope[] | undefined;\n\n\t// detached \u662F\u5426\u662F\u72EC\u7ACB\u7684\uFF0C\u9ED8\u8BA4\u4E0D\u662F\u72EC\u7ACB\u7684\uFF0C\u53D7\u7236\u4F5C\u7528\u57DF\u63A7\u5236\n\tconstructor(public detached: boolean = false) {\n\t\t// \u4E0D\u662F\u72EC\u7ACB\u7684\u5C31\u4F1A\u6536\u96C6\u8D77\u6765\uFF0C\u7236\u4F5C\u7528\u57DFstop\uFF0C\u5B50\u4F5C\u7528\u57DF\u4E5F\u4F1Astop\n\t\t// \u5982\u679C\u662F\u72EC\u7ACB\u7684\uFF0C\u5219\u4E0D\u4F1A\uFF0C\u5B50\u4F5C\u7528\u57DFscope\u5185\u90E8\u7684\u4EE3\u7801\u4E0D\u53D7\u5F71\u54CD\n\t\tif (!detached && activeEffectScope) {\n\t\t\t// \u6536\u96C6\u4F5C\u7528\u57DF\n\t\t\t(activeEffectScope.scopes || (activeEffectScope.scopes = [])).push(this);\n\t\t}\n\t}\n\n\trun<T>(fn: () => T): T | undefined {\n\t\tif (this._active) {\n\t\t\ttry {\n\t\t\t\tthis.parent = activeEffectScope;\n\t\t\t\tactiveEffectScope = this;\n\t\t\t\treturn fn();\n\t\t\t} finally {\n\t\t\t\tactiveEffectScope = this.parent;\n\t\t\t\tthis.parent = undefined;\n\t\t\t}\n\t\t}\n\t}\n\n\t// \u5C06\u6536\u96C6\u5230\u7684effect\u5168\u90E8stop\n\tstop() {\n\t\tif (this._active) {\n\t\t\tif (this.effects) {\n\t\t\t\tthis.effects.forEach(effect => {\n\t\t\t\t\teffect.stop();\n\t\t\t\t});\n\t\t\t\tthis.effects.length = 0;\n\t\t\t}\n\n\t\t\tif (this.cleanups) {\n\t\t\t\tthis.cleanups.forEach(fn => fn());\n\t\t\t}\n\n\t\t\t// \u5982\u679C\u6709\u5B50\u4F5C\u7528\u57DF\uFF0C\u8868\u660E\u5B50\u4F5C\u7528\u57DF\u4E0D\u662F\u72EC\u7ACB\u7684\uFF0C\u6267\u884C\u5B50\u4F5C\u7528\u57DF\u7684stop\n\t\t\tif (this.scopes) {\n\t\t\t\tthis.scopes.forEach(self => {\n\t\t\t\t\tself.stop();\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis._active = false;\n\t\t}\n\t}\n}\n\nexport function effectScope(detached?: boolean): EffectScope {\n\treturn new EffectScope(detached);\n}\n\nexport function recordEffectScope(effect: ReactiveEffect) {\n\tif (activeEffectScope) {\n\t\t// \u6536\u96C6effect\n\t\t(activeEffectScope.effects || (activeEffectScope.effects = [])).push(effect);\n\t}\n}\n\nexport function getCurrentScope(): EffectScope | undefined {\n\treturn activeEffectScope;\n}\n\nexport function onScopeDispose(fn: () => void) {\n\tif (activeEffectScope) {\n\t\t(activeEffectScope.cleanups || (activeEffectScope.cleanups = [])).push(fn);\n\t}\n}\n", "import { isArray } from '@vue/shared';\nimport { Dep, createDep } from './dep';\nimport { recordEffectScope } from './effectScope';\n\n// \u5168\u5C40\u7684effect\nexport let activeEffect: ReactiveEffect | undefined;\n\n//  weakMap = {\n// \t \t\ttarget: {\n// \t \t\t\tkey: Set<ReactiveEffect, ReactiveEffect, ReactiveEffect>\n// \t \t\t}\n// \t }\nconst targetMap = new WeakMap<any, Map<any, Dep>>();\n\nexport type EffectScheduler = (...args: any[]) => any;\n\nexport interface ReactiveEffectRunner<T = any> {\n\t(): T;\n\teffect: ReactiveEffect;\n}\n\nexport interface ReactiveEffectOptions {\n\tscheduler?: EffectScheduler;\n}\n\n// \u57FA\u7C7B\uFF1A\u4F5C\u4E3A\u54CD\u5E94\u5F0F\u7CFB\u7EDF\u7684\u6700\u5E95\u5C42\u7684\u63D0\u4F9B\u8005\uFF0Ccomputed\u3001watch\u90FD\u662F\u57FA\u4E8EReactiveEffect\u6765\u505A\uFF0C\u5185\u90E8\u4FDD\u5B58\u7740\u5F53\u524D\u6536\u96C6\u4F9D\u8D56\u7684\u91CD\u8981\u5C5E\u6027deps\n// \u6838\u5FC3\u65B9\u6CD5\uFF1Arun\uFF0C\u8BB0\u5F55\u5F53\u524D\u7684activeEffect\uFF0C\u8868\u660Eproxy\u5BF9\u8C61get\u65B9\u6CD5\u662F\u5426\u662F\u5728effect\u4E2D\uFF0C\u662F\u5C31\u4F1A\u89E6\u53D1\u4F9D\u8D56\u6536\u96C6\u3002\nexport class ReactiveEffect<T = any> {\n\t// \u6807\u8BB0\u5F53\u524Deffect\u662F\u5426\u662F\u6FC0\u6D3B\u72B6\u6001\uFF0C\u5982\u679C\u662F\u6FC0\u6D3B\u72B6\u6001\uFF0C\u4F1A\u89E6\u53D1\u4F9D\u8D56\u6536\u96C6\n\tactive = true;\n\t// \u6536\u96C6\u5F53\u524D\u6FC0\u6D3B\u7684activeEffect\n\tdeps: Dep[] = [];\n\t// \u6807\u8BB0\u5F53\u524D\u7684effect\n\t/**\n\t * effect(() => {\n\t * \tthis.name e1\n\t * \t effect(() => {\n\t * \t\t\tthis.name  e2\n\t * \t })\n\t * \t this.name  \u8FD9\u91CC\u5FC5\u987B\u662F e1\n\t * })\n\t *\n\t * \u7B2C\u4E00\u4E2Aeffect\u6267\u884C\n\t * parent -> activeEffect -> this\n\t * \u51FD\u6570\u6267\u884C\u5B8C\u6210\n\t * activeEffect = this.parent\n\t * parent = undefined\n\t *\n\t * \u7B2C\u4E8C\u4E2Aeffect\u6267\u884C\n\t * parent -> activeEffect\n\t *\n\t * e1 -> e2 -> e1\n\t */\n\tparent: ReactiveEffect | undefined = undefined;\n\t// scheduler\u8BB0\u5F55\u7740\uFF1Aproxy\u5BF9\u8C61set\u4E86\u65B0\u7684\u503C\uFF0C\u4F1A\u89E6\u53D1scheduler\u56DE\u8C03\uFF0C\u63A7\u5236\u4F9D\u8D56\u66F4\u65B0\u65F6\u673A\n\t// \u8FD9\u91CC\u4E5F\u53EF\u4EE5\u8BA4\u4E3A\u662F proxy\u5BF9\u8C61\u7684\u5C5E\u6027\u53D1\u751F\u4E86\u53D8\u5316\n\n\tconstructor(public fn: () => T, public scheduler: EffectScheduler | null = null) {\n\t\t// effectScope\u6536\u96C6effect\n\t\trecordEffectScope(this);\n\t}\n\n\trun() {\n\t\t// \u5982\u679C\u4E0D\u662F\u6FC0\u6D3B\u6001\uFF0C\u76F4\u63A5\u8FD4\u56DE\u56DE\u8C03\u51FD\u6570\u6267\u884C\u7ED3\u679C\n\t\tif (!this.active) {\n\t\t\treturn this.fn();\n\t\t}\n\n\t\ttry {\n\t\t\tthis.parent = activeEffect;\n\t\t\tactiveEffect = this;\n\n\t\t\t// \u6267\u884C\u4F9D\u8D56\u56DE\u8C03\u4E4B\u524D\uFF0C\u5148\u6E05\u7A7A\u6536\u96C6\u7684effects\n\t\t\tcleanupEffect(this);\n\t\t\treturn this.fn();\n\t\t} finally {\n\t\t\t// e1\n\t\t\tactiveEffect = this.parent;\n\t\t\tthis.parent = undefined;\n\t\t}\n\t}\n\n\tstop() {\n\t\tif (this.active) {\n\t\t\tcleanupEffect(this);\n\t\t\tthis.active = false;\n\t\t}\n\t}\n}\n\nexport function effect<T = any>(fn: () => T, options?: ReactiveEffectOptions) {\n\tconst _effect = new ReactiveEffect(fn, options?.scheduler);\n\n\tif (!options) {\n\t\t_effect.run();\n\t}\n\n\tconst runner = _effect.run.bind(_effect) as ReactiveEffectRunner;\n\trunner.effect = _effect;\n\treturn runner;\n}\n\nexport function stop(runner: ReactiveEffectRunner) {\n\trunner.effect.stop();\n}\n\n/**\n * \u6536\u96C6\u4F9D\u8D56\n * \u6536\u96C6\u6570\u636E\u683C\u5F0F\u5982\u4E0B\uFF1A\n * weakMap = {\n * \t\ttarget: {\n * \t\t\tkey: Set<ReactiveEffect, ReactiveEffect, ReactiveEffect>\n * \t\t}\n * }\n *\n * \u56E0\u4E3A\u4E00\u4E2A\u53D6\u503C\u64CD\u4F5C\u53EF\u4EE5\u53D1\u751F\u5728\u591A\u4E2Aeffect\u4E2D\uFF0C\u6240\u4EE5Set\u91CC\u9762\u4F1A\u6709\u591A\u4E2AReactiveEffect\n *\n * @param target\n * @param key\n */\nexport function track(target: object, key: unknown) {\n\tif (activeEffect) {\n\t\t// \u8BF4\u660E\u5F53\u524D\u53D6\u503C\u64CD\u4F5C\u53D1\u751F\u5728effect\u4E2D\n\t\tlet depsMap = targetMap.get(target);\n\t\tif (!depsMap) {\n\t\t\t// \u4E0D\u5B58\u5728\uFF0C\u521B\u5EFA\u4E00\u4E2A\u7A7Amap\n\t\t\ttargetMap.set(target, (depsMap = new Map()));\n\t\t}\n\t\tlet dep = depsMap.get(key);\n\t\tif (!dep) {\n\t\t\tdepsMap.set(key, (dep = new Set<ReactiveEffect>()));\n\t\t}\n\t\ttrackEffects(dep);\n\t}\n}\n\nexport function trackEffects(dep: Dep) {\n\tlet shouldTrack = !dep.has(activeEffect);\n\tif (shouldTrack) {\n\t\t// \u5982\u679CSet\u4E2D\u6CA1\u6709\u5F53\u524D\u6FC0\u6D3B\u7684activeEffect\uFF0C\u9700\u8981\u505A\u6536\u96C6\n\t\tdep.add(activeEffect);\n\t\tactiveEffect.deps.push(dep);\n\t}\n}\n\n/**\n * \u89E6\u53D1\u4F9D\u8D56\u66F4\u65B0\n * @param target\n * @param key\n * @param newValue\n * @param oldValue\n */\nexport function trigger(target: object, key: unknown, newValue: unknown, oldValue: unknown) {\n\tconst depsMap = targetMap.get(target);\n\t// \u6CA1\u6709\u6536\u96C6\u8BE5\u5BF9\u8C61\n\tif (!depsMap) {\n\t\treturn;\n\t}\n\n\tlet deps: (Dep | undefined)[] = [];\n\tif (key !== undefined) {\n\t\tdeps.push(depsMap.get(key));\n\t}\n\n\t// copy\u4E00\u4EFDdeps\uFF0C\u6E05\u7406\u4F9D\u8D56\u65F6\u5019\uFF0C\u9632\u6B62\u6B7B\u5FAA\u73AF\n\tconst effects: ReactiveEffect[] = [];\n\tfor (const dep of deps) {\n\t\tif (dep) {\n\t\t\teffects.push(...dep);\n\t\t}\n\t}\n\ttriggerEffects(createDep(effects));\n}\n\nexport function triggerEffects(dep: Dep | ReactiveEffect[]) {\n\tif (dep) {\n\t\tconst effects = isArray(dep) ? dep : [...dep];\n\t\tif (effects) {\n\t\t\teffects.forEach(effect => {\n\t\t\t\t/**\n\t\t\t\t * effect(() => {\n\t\t\t\t * \t\tstate.name = 123123\n\t\t\t\t * })\n\t\t\t\t *\n\t\t\t\t * \u4E3A\u4E86\u9632\u6B62\u5728\u4F9D\u8D56\u4E2D\u66F4\u65B0\u54CD\u5E94\u5F0F\u6570\u636E\uFF0C\u9020\u6210\u6B7B\u5FAA\u73AF\uFF0C\u8FD9\u91CC\u8981\u505A\u5224\u65AD\uFF0C\n\t\t\t\t * \u5982\u679C\u5F53\u524D\u6B63\u5728\u6267\u884C\u7684effect === \u5168\u5C40\u4E2DactiveEffect\uFF0C\u8868\u660E\u6B64effect\u6B63\u5728\u6267\u884C\n\t\t\t\t *\n\t\t\t\t */\n\t\t\t\tif (activeEffect !== effect) {\n\t\t\t\t\tif (effect.scheduler) {\n\t\t\t\t\t\teffect.scheduler();\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// \u66F4\u65B0\u4F9D\u8D56\n\t\t\t\t\t\teffect.run();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n}\n\n/**\n * \u6E05\u7406\u4F9D\u8D56\n * @param effect \u5F53\u524D\u7684effect\n */\nexport function cleanupEffect(effect: ReactiveEffect) {\n\tconst { deps } = effect;\n\tif (deps.length) {\n\t\tfor (let index = 0; index < deps.length; index++) {\n\t\t\tdeps[index].delete(effect);\n\t\t}\n\t\tdeps.length = 0;\n\t}\n}\n", "import { hasChanged, isArray, isObject } from '@vue/shared';\nimport { Dep, createDep } from './dep';\nimport { activeEffect, trackEffects, triggerEffects } from './effect';\nimport { isReactive, toRaw, toReactive } from './reactive';\n\nexport interface Ref<T = any> {\n\tdep: Dep;\n\tvalue: T;\n}\n\nexport type MaybeRef<T = any> = T | Ref<T>;\n\nexport function unref<T>(ref: MaybeRef<T>): T {\n\treturn isRef(ref) ? ref.value : ref;\n}\n\nexport function isRef<T>(ref: Ref<T> | unknown): ref is Ref<T>;\nexport function isRef(ref: any): ref is Ref {\n\treturn !!(ref && ref.__v_isRef === true);\n}\n\nexport function ref(value: unknown) {\n\treturn createRef(value, false);\n}\n\nexport function shallowRef(value: unknown) {\n\treturn createRef(value, true);\n}\n\nfunction createRef(value: unknown, shallow: boolean) {\n\t// ref(ref(true))\n\t// \u5982\u679C\u672C\u8EAB\u5C31\u662Fref, \u8FD4\u56DE\u5176\u672C\u8EAB\n\tif (isRef(value)) {\n\t\treturn value;\n\t}\n\treturn new RefImpl(value, shallow);\n}\n\nclass RefImpl<T> {\n\tpublic dep: Dep = undefined;\n\n\t// \u5185\u90E8\u7F13\u5B58\u7684\u503C,\u7528\u4F5Cget\u65B9\u6CD5\u653E\u56DE\u7684\u503C\n\tprivate _value: T = undefined;\n\n\t// \u5185\u90E8\u7F13\u5B58\u7684\u539F\u59CB\u503C\uFF0C\u7528\u4F5C\u65B0 \u8001\u503C\u53D8\u5316\u7684\u6BD4\u8F83\n\tprivate _rawValue: T = undefined;\n\n\tpublic readonly __v_isRef = true;\n\tconstructor(value: T, public readonly __v_isShallow: boolean) {\n\t\t// 1\uFF1A\u5982\u679C\u662Fshallow \u4FDD\u5B58\u539F\u59CB\u503C\n\t\t// 2\uFF1A\u5982\u679C\u662Fref, value\u6709\u53EF\u80FD\u4E5F\u662F\u54CD\u5E94\u5F0F\u5BF9\u8C61, \u4F1A\u5BF9\u5176\u89E3\u5305\uFF0C\u53D8\u4E3A\u666E\u901A\u5BF9\u8C61\n\t\tthis._rawValue = __v_isShallow ? value : toRaw(value);\n\t\t// 1\uFF1A\u5982\u679C\u662Fshallow\uFF0C\u4FDD\u5B58\u539F\u59CB\u503C\uFF0C\n\t\t// 2\uFF1A\u5982\u679C\u662F\u5BF9\u8C61\uFF0C\u8F6C\u5316\u6210reactive\u5BF9\u8C61\uFF0C\u5982\u679C\u4E0D\u662F\u5BF9\u8C61\uFF0C\u8FD4\u56DE\u5176\u539F\u59CB\u503C\n\t\t// 3\uFF1A\u652F\u6301\u4E0B\u9762\u4E24\u79CD\uFF1Aref(\u57FA\u672C\u6570\u636E\u7C7B\u578B)\u3001ref({})\u3001ref(reactive({}))\n\t\tthis._value = __v_isShallow ? value : toReactive(value);\n\t}\n\n\tget value() {\n\t\t// \u4F9D\u8D56\u6536\u96C6\n\t\ttrackRefValue(this);\n\t\treturn this._value;\n\t}\n\n\tset value(newValue) {\n\t\t/**\n\t\t * 1: shallowRef\u5BF9\u6BD4\u7684\u662F\u539F\u59CB\u503C\uFF0C\u56E0\u4E3A_vawValue _value\u4FDD\u5B58\u7684\u90FD\u662F\u539F\u59CB\u503C\n\t\t * @example\n\t\t * \tconst obj = {}\n\t\t *  const sRef = shallowRef(obj)\n\t\t *  sRef.value === obj  // true\n\t\t *\n\t\t * \tsRef.value = {a: 1}\n\t\t *\n\t\t * \t\u5BF9\u6BD4\u7684\u662F\u539F\u59CB\u503C\uFF1A {a: 1} === {}\n\t\t *\n\t\t *  \u6240\u4EE5shallowRef\u60F3\u8981\u76D1\u542C\u5176\u53D8\u5316\uFF0C\u5FC5\u987B\u8981\u66F4\u6539\u6574\u4E2A\u5BF9\u8C61 sRef.value = new Object\n\t\t */\n\n\t\t/**\n\t\t * 2: ref.value = xxx\n\t\t */\n\n\t\t// \u6709\u53EF\u80FD\u5916\u90E8\u4F20\u5165\u54CD\u5E94\u5F0F\u5BF9\u8C61 newValue = reactive\u3001 ref\n\t\t// \u73B0\u5BF9\u5176\u7ED3\u6784\u6210\u539F\u59CB\u503C\n\t\tnewValue = this.__v_isShallow ? newValue : toRaw(newValue);\n\t\tif (hasChanged(newValue, this._rawValue)) {\n\t\t\tthis._rawValue = newValue;\n\t\t\tthis._value = this.__v_isShallow ? newValue : toReactive(newValue);\n\t\t\t// \u89E6\u53D1\u66F4\u65B0\n\t\t\ttriggerRefValue(this);\n\t\t}\n\t}\n}\n\n// \u6536\u96C6\u4F9D\u8D56\nexport function trackRefValue(ref: Ref<any>) {\n\t// \u5982\u679C\u662F\u5728effect\u4E2D\u8BBF\u95EE\n\tif (activeEffect) {\n\t\ttrackEffects(ref.dep || (ref.dep = createDep()));\n\t}\n}\n\n// \u89E6\u53D1\u4F9D\u8D56\u66F4\u65B0\nexport function triggerRefValue(ref: Ref<any>) {\n\tconst dep = ref.dep;\n\tif (dep) {\n\t\ttriggerEffects(dep);\n\t}\n}\n\nexport function toRef(source: Record<string, any> | MaybeRef, key?: string) {\n\tif (isRef(source)) {\n\t\treturn source;\n\t} else if (isObject(source)) {\n\t\treturn propertyToRef(source, key);\n\t} else {\n\t\t// \u5305\u88C5\u6210 ref\n\t\treturn ref(source);\n\t}\n}\n\nexport function toRefs<T extends object>(object: T) {\n\tconst res: any = isArray(object) ? new Array(object.length) : {};\n\tfor (const key in object) {\n\t\tres[key] = propertyToRef(object, key);\n\t}\n\treturn res;\n}\n\nfunction propertyToRef(source: Record<string, any> | MaybeRef, key?: string) {\n\tconst value = source[key];\n\treturn isRef(value) ? value : new ObjectRefImpl(source, key);\n}\n\nclass ObjectRefImpl<T extends object, K extends keyof T> {\n\tpublic readonly __v_isRef = true;\n\tconstructor(private readonly _object: T, private readonly _key: K) {}\n\n\t// ref.value\n\tget value() {\n\t\t// _object\u662F\u54CD\u5E94\u5F0F\u5BF9\u8C61\uFF0C\u8FD9\u91CC\u53D6\u503C\u4F1A\u89E6\u53D1\u4F9D\u8D56\u6536\u96C6\n\t\treturn this._object[this._key];\n\t}\n\n\tset value(newValue) {\n\t\t// \u89E6\u53D1\u4F9D\u8D56\u66F4\u65B0\n\t\tthis._object[this._key] = newValue;\n\t}\n}\n\n// \u5BF9ref\u505A\u89E3\u5305\nexport function proxyRefs<T>(objectWithRef: Ref<T>) {\n\t// \u5982\u679C\u662Freactive \u76F4\u63A5\u8FD4\u56DE\u672C\u8EAB\n\treturn isReactive(objectWithRef)\n\t\t? objectWithRef\n\t\t: new Proxy(objectWithRef, {\n\t\t\t\tget(target, key, receiver) {\n\t\t\t\t\treturn unref(Reflect.get(target, key, receiver));\n\t\t\t\t},\n\t\t\t\tset(target, key, newValue, receiver) {\n\t\t\t\t\tconst oldValue = target[key];\n\t\t\t\t\t// \u5982\u679C\u8001\u503C\u662Fref\uFF0C\u5E76\u4E14newValue\u4E0D\u80FD\u662Fref\n\t\t\t\t\tif (isRef(oldValue) && !isRef(newValue)) {\n\t\t\t\t\t\toldValue.value = newValue;\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\treturn Reflect.set(target, key, newValue, receiver);\n\t\t\t\t}\n\t\t  });\n}\n", "import { hasChanged, isObject } from '@vue/shared';\nimport { track, trigger } from './effect';\nimport { ReactiveFlags, reactive, readonly, readonlyMap, reactiveMap } from './reactive';\nimport { isRef } from './ref';\n\nconst set = createSetter();\nfunction createSetter() {\n\treturn function set(target: object, key: string | symbol, value: unknown, receiver: object) {\n\t\tconst oldValue = target[key];\n\t\t// Reflect\u53CD\u5C04 \u5904\u7406\u4E86this\u6307\u5411\u95EE\u9898\n\t\tconst result = Reflect.set(target, key, value, receiver);\n\n\t\t// \u65B0\u503C\u8001\u503C\u4E0D\u76F8\u7B49\uFF0C\u89E6\u53D1\u4F9D\u8D56\u66F4\u65B0\n\t\tif (hasChanged(value, oldValue)) {\n\t\t\t// \u89E6\u53D1\u66F4\u65B0\n\t\t\ttrigger(target, key, value, oldValue);\n\t\t}\n\n\t\treturn result;\n\t};\n}\nconst get = createGetter(false);\n\nconst readonlyGet = createGetter(true);\n\nfunction createGetter(isReadonly = false) {\n\treturn function get(target: object, key: string | symbol, receiver: object) {\n\t\tif (key === ReactiveFlags.IS_REACTIVE) {\n\t\t\t// \u8FD9\u91CC\u8868\u660Etarget\u662F\u4EE3\u7406\u5BF9\u8C61\n\t\t\treturn !isReadonly;\n\t\t} else if (key === ReactiveFlags.IS_READONLY) {\n\t\t\treturn isReadonly;\n\t\t} else if (key === ReactiveFlags.RAW && receiver === (isReadonly ? readonlyMap : reactiveMap.get(target))) {\n\t\t\treturn target;\n\t\t}\n\n\t\t// readonly \u4E0D\u6536\u96C6\u4F9D\u8D56\n\t\tif (!isReadonly) {\n\t\t\t// \u4F9D\u8D56\u6536\u96C6\n\t\t\ttrack(target, key);\n\t\t}\n\n\t\tconst res = Reflect.get(target, key, receiver);\n\n\t\tif (isRef(res)) {\n\t\t\t// \u5982\u679Cvalue\u662FRef\u7C7B\u578B\uFF0C \u89E3\u5305 Ref\n\t\t\treturn res.value;\n\t\t}\n\n\t\t// \u5904\u7406\u6DF1\u5C42\u6B21\u54CD\u5E94\u5F0F\u5BF9\u8C61\uFF0C\u5982\u679C\u8FD4\u56DE\u503C\u662F\u5BF9\u8C61\uFF0C\u9700\u8981\u518D\u5BF9 \u5BF9\u8C61 \u505A\u4E00\u6B21\u4EE3\u7406\n\t\tif (isObject(res)) {\n\t\t\treturn isReadonly ? readonly(res) : reactive(res);\n\t\t}\n\n\t\treturn res;\n\t};\n}\n\nexport const mutableHandlers: ProxyHandler<object> = {\n\tset,\n\tget\n};\n\nexport const readonlyHandlers: ProxyHandler<object> = {\n\t// \u53EA\u8BFB\u5C5E\u6027\u4E0D\u80FD\u88ABset\n\tset(target, key) {\n\t\tconsole.warn(`Set operation on key \"${String(key)}\" failed: target is readonly.`, target);\n\t\treturn true;\n\t},\n\t// \u53EA\u8BFB\u5C5E\u6027\u4E0D\u80FD\u88AB\u5220\u9664\n\tdeleteProperty(target, key) {\n\t\tconsole.warn(`Delete operation on key \"${String(key)}\" failed: target is readonly.`, target);\n\t\treturn true;\n\t},\n\tget: readonlyGet\n};\n", "import { isObject } from '@vue/shared';\nimport { mutableHandlers, readonlyHandlers } from './baseHandlers';\n\nexport const enum ReactiveFlags {\n\tSKIP = '__v_skip',\n\tIS_REACTIVE = '__v_isReactive',\n\tIS_READONLY = '__v_isReadonly',\n\tIS_SHALLOW = '__v_isShallow',\n\tRAW = '__v_raw'\n}\n\nexport interface Target {\n\t[ReactiveFlags.SKIP]?: boolean;\n\t[ReactiveFlags.IS_REACTIVE]?: boolean;\n\t[ReactiveFlags.IS_READONLY]?: boolean;\n\t[ReactiveFlags.IS_SHALLOW]?: boolean;\n\t[ReactiveFlags.RAW]?: any;\n}\n\nexport const reactiveMap = new WeakMap<Target, any>();\nexport const readonlyMap = new WeakMap<Target, any>();\n\nexport const isReadonly = (value: unknown) => {\n\t// \u5C5E\u6027\u8BBF\u95EE \u89E6\u53D1 readonlyHandlers.get \u65B9\u6CD5\uFF0C\u5176\u5185\u90E8\u5224\u65AD\u4E86key === ReactiveFlags.IS_READONLY\n\treturn !!(value && (value as Target)[ReactiveFlags.IS_READONLY]);\n};\n\nexport const isReactive = (value: unknown): boolean => {\n\tif (isReadonly(value)) {\n\t\treturn isReactive((value as Target)[ReactiveFlags.RAW]);\n\t}\n\treturn !!(value && (value as Target)[ReactiveFlags.IS_REACTIVE]);\n};\n\nexport function isProxy(value: unknown): boolean {\n\treturn isReadonly(value) || isReactive(value);\n}\n\n// \u7B2C\u4E00\u6B21\u6267\u884C observed\u662F\u54CD\u5E94\u5F0F\u5BF9\u8C61\uFF0C\u8BBF\u95EEReactiveFlags.RAW\u89E6\u53D1proxy set\u65B9\u6CD5\uFF0C\n// \u89E6\u53D1proxy set\u65B9\u6CD5\u8FD4\u56DEreadonlyMap \u6216\u8005 reactiveMap\u4FDD\u5B58\u7684\u6E90\u5BF9\u8C61\uFF0C\n// \u7B2C\u4E8C\u6B21\u6267\u884C\uFF0C\u6E90\u5BF9\u8C61\u4E2D\u6CA1\u6709ReactiveFlags.RAW\u5C5E\u6027\uFF0C\u76F4\u63A5\u8FD4\u56DE\u6E90\u5BF9\u8C61\nexport function toRaw<T>(observed: T): T {\n\tconst raw = observed && (observed as Target)[ReactiveFlags.RAW];\n\treturn raw ? toRaw(raw) : observed;\n}\n\n// \u8F6C\u6210\u54CD\u5E94\u5F0F\u5BF9\u8C61\nexport function toReactive<T extends unknown>(value: T): T {\n\treturn isObject(value) ? reactive(value as any) : value;\n}\n\nexport function readonly(target: object) {\n\treturn createReactiveObject(target, true, readonlyHandlers, readonlyMap);\n}\n\nexport function reactive<T extends object>(target: T) {\n\t/**\n\t * @example\n\t * const state = reactive({})\n\t * const readonlyS = readonly(state)\n\t * \u5982\u679C\u662Freadonly\u8FD4\u56DE\u7684\u54CD\u5E94\u5F0F\u5BF9\u8C61\uFF0C\u8FD4\u56DE\u5176\u672C\u8EAB\n\t */\n\tif (isReadonly(target)) {\n\t\treturn target;\n\t}\n\n\treturn createReactiveObject(target, false, mutableHandlers, reactiveMap);\n}\n\nexport function createReactiveObject(\n\ttarget: Target,\n\tisReadonly: boolean,\n\tbaseHandlers: ProxyHandler<any>,\n\tproxyMap: WeakMap<Target, any>\n) {\n\tif (!isObject(target)) {\n\t\treturn target;\n\t}\n\t// \u5224\u65AD\u5BF9\u8C61\u662F\u5426\u88AB\u4EE3\u7406\u8FC7\uFF0C\u5982\u679C\u662F\uFF0C\u8FD4\u56DE\u4EE3\u7406\u5BF9\u8C61\n\t/** \u573A\u666F\uFF1A\n\t *  const obj = {a: 1}\n\t * \tconst state = reactive(obj);\n\t\t\tconst state2 = reactive(obj);\n\t\t\tstate === state2  true\n\t */\n\tconst existingProxy = proxyMap.get(target);\n\tif (existingProxy) {\n\t\treturn existingProxy;\n\t}\n\n\t// \u5982\u679C\u4EE3\u7406\u5BF9\u8C61\u518D\u5305\u88C5\u6210reactive\uFF0C\u8FD9\u91CC\u53D6\u503C\u4F1A\u89E6\u53D1 proxy get\u65B9\u6CD5\n\t/** \u573A\u666F\uFF1A\n\t *  const obj = {a: 1}\n\t * \tconst state = reactive(obj);\n\t\t\tconst state2 = reactive(state);\n\t\t\tstate === state2  true\n\t */\n\n\t// \u6392\u9664 readonly(), readonly \u5305\u88C5\u7684\u662Fproxy\u5BF9\u8C61\uFF0C\u4E0D\u80FD\u8FD4\u56DE\u5DF2\u88AB\u4EE3\u7406\u5BF9\u8C61\uFF0C\u8981\u8FD4\u56DE\u65B0\u7684\u4EE3\u7406\u5BF9\u8C61\uFF0C\u62E6\u622Aset,delete,get\u65B9\u6CD5\n\tif (target[ReactiveFlags.IS_REACTIVE] && !isReadonly) {\n\t\treturn target;\n\t}\n\n\tconst proxy = new Proxy(target, baseHandlers);\n\n\t// \u7F13\u5B58\u4EE3\u7406\u5BF9\u8C61\n\tproxyMap.set(target, proxy);\n\treturn proxy;\n}\n", "import {\n\tData,\n\tVNode,\n\tVNodeArrayChildren,\n\tVNodeProps,\n\tisSameVNodeType,\n\tnormalizeVNode,\n\tText,\n\tComment,\n\tFragment\n} from '@vue/runtime-core';\nimport { EMPTY_OBJ, ShapeFlags, isReservedProp } from '@vue/shared';\nimport { createComponentInstance, setupComponent } from './components';\nimport { ComponentInternalInstance, renderComponentRoot } from './componentRenderUtils';\nimport { ReactiveEffect } from '@vue/reactivity';\nimport { SchedulerJob } from './scheduler';\n\nexport interface Renderer<HostElement = RendererElement> {\n\trender: RootRenderFunction<HostElement>;\n}\n\n// \u589E\u5220\u6539\u67E5\nexport interface RendererOptions<HostNode = RendererNode, HostElement = RendererElement> {\n\tpatchProp(el: RendererElement, key: string, preValue: any, nextValue: any): void;\n\t/**\n\t * \u63D2\u5165 (\u589E\u52A0\u3001\u79FB\u52A8)\n\t * @param el \u5B50\u8282\u70B9\n\t * @param parent \u7236\u5143\u7D20\n\t * @param anchor \u63CF\u70B9 \u8282\u70B9\n\t */\n\tinsert(el: HostNode, parent: HostElement, anchor: HostNode | null): void;\n\t/**\n\t * \u5220\u9664\n\t * @param el \u5B50\u8282\u70B9\n\t */\n\tremove(el: HostNode): void;\n\t/**\n\t * \u65B0\u589E\u4E00\u4E2A\u8282\u70B9\n\t * @param tagName tageName\n\t * @param props \u5C5E\u6027\n\t */\n\tcreateElement(tagName: string, props?: VNodeProps): HostElement;\n\n\t/**\n\t * \u521B\u5EFA\u6587\u672CNode\n\t * @param text \u6587\u672C\u5185\u5BB9\n\t */\n\tcreateText(text: string): Text;\n\n\t/**\n\t * \u8BBE\u7F6E\u8282\u70B9\u5185\u5BB9\n\t * @param el \u8282\u70B9\n\t * @param text \u6587\u672C\u5185\u5BB9\n\t */\n\tsetText(el: HostNode, text: string): void;\n\n\t/**\n\t * \u8BBE\u7F6E\u5143\u7D20\u7684textContent\n\t * @param el\n\t * @param text\n\t */\n\tsetElementText(el: HostElement, text: string): void;\n\n\t/**\n\t * \u6CE8\u91CA\u8282\u70B9\n\t * @param data \u6CE8\u91CA\u5185\u5BB9\n\t */\n\tcreateComment(data: string): Comment;\n\n\t/**\n\t * \u83B7\u53D6\u7236\u8282\u70B9\n\t * @param node \u5B50\u8282\u70B9\n\t */\n\tparentNode(child: HostNode): HostElement;\n\n\t/**\n\t * \u83B7\u53D6\u5144\u5F1F\u8282\u70B9\n\t * @param node\n\t */\n\tnextSibling(node: HostNode): HostNode;\n\n\tquertSelector(selector: string): HostElement;\n}\n\nexport interface RendererNode {\n\t[key: string]: any;\n}\n\nexport interface RendererElement extends RendererNode {}\n\nexport type RootRenderFunction<HostElement = RendererElement> = (vnode: VNode | null, container: HostElement) => void;\n\n/**\n * n1 \u6807\u8BC6\u5DF2\u7ECF\u8001\u8282\u70B9\uFF0Cn2\u6807\u8BC6\u65B0\u8282\u70B9  container\u6807\u8BC6\u6E32\u67D3\u8DDF\u5143\u7D20\n */\ntype PatchFn = (\n\tn1: VNode | null,\n\tn2: VNode,\n\tcontainer: RendererElement,\n\tanchor?: RendererNode | null,\n\tparentComponent?: ComponentInternalInstance | null\n) => void;\n\ntype NextFn = (vnode: VNode) => RendererNode;\n\ntype ProcessTextFn = (n1: VNode | null, n2: VNode, container: RendererElement, anchor: RendererNode | null) => void;\n\ntype ProcessCommentFn = (n1: VNode | null, n2: VNode, container: RendererElement, anchor: RendererNode | null) => void;\n\ntype ProcessElementFn = (n1: VNode | null, n2: VNode, container: RendererElement, anchor: RendererNode | null) => void;\n\ntype ProcessComponentFn = (\n\tn1: VNode | null,\n\tn2: VNode,\n\tcontainer: RendererElement,\n\tanchor: RendererNode | null,\n\tparentComponent?: ComponentInternalInstance | null\n) => void;\n\ntype MountElementFn = (vnode: VNode, container: RendererElement, anchor: RendererNode | null) => void;\n\ntype PatchElementFn = (n1: VNode | null, n2: VNode) => void;\n\ntype UnmountFn = (vnode: VNode) => void;\n\ntype RemoveFn = (vnode: VNode) => void;\n\ntype PatchPropsFn = (el: RendererElement, oldProps: Data, newProps: Data) => void;\n\ntype PatchChildrenFn = (n1: VNode | null, n2: VNode, container: RendererElement, anchor: RendererNode | null) => void;\n\ntype UnmountChildrenFn = (children: VNode[]) => void;\n\ntype MountChildrenFn = (\n\tchildren: VNodeArrayChildren,\n\tcontainer: RendererElement,\n\tanchor: RendererNode | null,\n\tstart?: number\n) => void;\n\nexport type SetupRenderEffectFn = (\n\tinstance: ComponentInternalInstance,\n\tinitialVNode: VNode,\n\tcontainer: RendererElement,\n\tanchor: RendererNode | null\n) => void;\n\nexport function createRenderer(options: RendererOptions) {\n\treturn baseCreateRenderer(options);\n}\n\nfunction baseCreateRenderer(options: RendererOptions) {\n\tconst {\n\t\tinsert: hostInsert,\n\t\tremove: hostRemove,\n\t\tpatchProp: hostPatchProp,\n\t\tcreateElement: hostCreateElement,\n\t\tcreateText: hostCreateText,\n\t\tcreateComment: hostCreateComment,\n\t\tsetText: hostSetText,\n\t\tsetElementText: hostSetElementText,\n\t\tparentNode: hostParentNode,\n\t\tnextSibling: hostNextSibling\n\t} = options;\n\n\t// \u6302\u8F7D\u5B50\u5143\u7D20\n\t// \u9012\u5F52\u5904\u7406children\n\t// eg. h('div', props, [h('span', props)])\n\tconst mountChildren: MountChildrenFn = (children, el, anchor, start = 0) => {\n\t\tfor (let i = start; i < children.length; i++) {\n\t\t\t// \u8FD9\u91CC\u7684child\u53EF\u80FD\u662F\u666E\u901A\u6587\u672C(string, number)\uFF0C\u4E5F\u53EF\u80FD\u662Fvnode\uFF0C\u4E5F\u53EF\u80FD\u662F [h('span'), h('div')]\n\t\t\tconst child = normalizeVNode(children[i]);\n\t\t\t// \u9012\u5F52\u5904\u7406\u6BCF\u4E2A\u5B50\u5143\u7D20\n\t\t\tpatch(null, child, el, anchor);\n\t\t}\n\t};\n\n\t// \u5378\u8F7D\u6240\u6709\u5B50\u5143\u7D20\n\tconst unmountChildren: UnmountChildrenFn = childrens => {\n\t\tfor (let i = 0; i < childrens.length; i++) {\n\t\t\tunmount(childrens[i]);\n\t\t}\n\t};\n\n\tfunction patchKeyedChildren(c1: VNode[], c2: VNodeArrayChildren, container: RendererElement) {\n\t\tlet i = 0;\n\t\t// \u6700\u5927\u957F\u5EA6\n\t\tconst l1 = c1.length;\n\t\tconst l2 = c2.length;\n\n\t\tlet e1 = l1 - 1; // \u8001\u7684\u6700\u540E\u4E00\u4E2A\n\t\tlet e2 = l2 - 1; // \u65B0\u503C\u6700\u540E\u4E00\u4E2A\n\n\t\t// ------- \u5F00\u59CB\u90E8\u5206\u76F8\u540C\u7684vnode \u6BD4\u8F83\n\n\t\t// 1\uFF1A \u4ECE\u5934\u5F00\u59CB\u67E5\u627E\n\n\t\t// a b c\n\t\t// a b c d\n\n\t\t// \u5F53\u8FBE\u5230 \u8001\u503C \u6216\u8005 \u65B0\u503C \u4EFB\u4F55\u4E00\u4E2A \u5C31\u7ED3\u675F\u5FAA\u73AF\n\t\twhile (i <= e1 && i <= e2) {\n\t\t\tconst n1 = c1[i];\n\t\t\t// n2 copy\u4E00\u4E0B\uFF0C\u907F\u514D\u76F4\u63A5\u4FEE\u6539\u7528\u6237\u4F20\u5165\u7684\u65B0\u503C\n\t\t\tconst n2 = normalizeVNode(c2[i]);\n\n\t\t\tif (isSameVNodeType(n1, n2)) {\n\t\t\t\t// \u8868\u793A\u662F\u540C\u4E00\u4E2A\u8282\u70B9\uFF0C\u9012\u5F52\u5904\u7406, \u6BD4\u8F83\u5185\u90E8\n\t\t\t\tpatch(n1, n2, container, null);\n\t\t\t} else {\n\t\t\t\t// \u5F53\u9047\u5230\u4E0D\u540C\u7684\u8282\u70B9\u65F6\uFF0C\u7ED3\u675F\u5FAA\u73AF\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\ti++;\n\t\t}\n\n\t\t// ------- \u7ED3\u5C3E\u90E8\u5206\u76F8\u540C\u7684vnode \u6BD4\u8F83\n\n\t\t// 2\uFF1A\u4ECE\u540E\u9762\u5F00\u59CB\u67E5\u627E\n\n\t\t//     b c\n\t\t// a f b c\n\n\t\twhile (i <= e1 && i <= e2) {\n\t\t\tconst n1 = c1[e1];\n\t\t\t// n2 copy\u4E00\u4E0B\uFF0C\u907F\u514D\u76F4\u63A5\u4FEE\u6539\u7528\u6237\u4F20\u5165\u7684\u65B0\u503C\n\t\t\tconst n2 = normalizeVNode(c2[e2]);\n\t\t\tif (isSameVNodeType(n1, n2)) {\n\t\t\t\tpatch(n1, n2, container, null);\n\t\t\t} else {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t// \u8FD9\u79CD\u60C5\u51B5\u4E0B \u5FAA\u73AF\u56E0\u5B50 i \u4E0D\u53D8\n\t\t\t// \u8001\u503C \u65B0\u503C \u540C\u65F6\u5F80\u524D\u63A8\u8FDB\n\t\t\te1--;\n\t\t\te2--;\n\t\t}\n\n\t\t// \u516C\u5171\u5E8F\u5217 \u5143\u7D20\u7684\u6302\u8F7D\n\t\t//  a b c\n\t\t//  a b c d\n\t\t//  i = 3; e1 = 2; e2 = 3;\n\n\t\t//      a c\n\t\t//  f e a c\n\t\t// i = 0; e1 = -1; e2 = 1;\n\n\t\t// \u6302\u8F7D\u65B0\u503C\u8981\u6EE1\u8DB3\u4E00\u4E0B\u6761\u4EF6\uFF1A\n\t\t// 1\uFF1A\u65B0\u503C\u4E00\u5B9A\u6BD4\u8001\u503C\u957F\uFF0C\u53EF\u4EE5\u7528 i \u6765\u5224\u65AD\uFF0C \u6B64\u65F6 i \u4E00\u5B9A\u662F\u5927\u4E8E \u8001\u503C e1\u7684\u957F\u5EA6\n\t\t// 2\uFF1A\u5FAA\u73AF\u56E0\u5B50 i \u8981\u5728\u65B0\u503C\u7684\u8303\u56F4\u5185\n\n\t\tif (i > e1) {\n\t\t\tif (i <= e2) {\n\t\t\t\t//  \u6302\u8F7D\u65B0\u503C\n\t\t\t\t// \u600E\u4E48\u83B7\u53D6\u63D2\u5165\u63CF\u70B9\uFF1F\n\t\t\t\t// 1\uFF1A\u5148\u83B7\u53D6\u4E0B\u4E00\u4E2A\u5143\u7D20\n\t\t\t\t// 2\uFF1A\u5982\u679C\u4E0B\u4E00\u4E2A\u5143\u7D20 \u4ECD\u7136\u5C0F\u4E8E\u65B0\u503C\u7684\u6700\u5927\u957F\u5EA6\uFF0C\u8BF4\u660E\u662F\u5411\u524D\u63D2\u5165\uFF0C\u5426\u5219\u5C31\u662F\u5411\u540E\u63D2\u5165\uFF0C\u5411\u540E\u63D2\u5165\u76F4\u63A5\u4F20null\u5373\u53EF\n\t\t\t\tconst nextPos = e2 + 1;\n\t\t\t\tconst anchor = nextPos < l2 ? (c2[nextPos] as VNode).el : null;\n\t\t\t\twhile (i <= e2) {\n\t\t\t\t\tpatch(null, normalizeVNode(c2[i]), container, anchor);\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// \u516C\u5171\u5E8F\u5217 \u5143\u7D20\u7684\u5378\u8F7D\n\n\t\t//  a b c\n\t\t//  a b\n\t\t//  i = 2; e1 = 2; e2 = 1;\n\n\t\t//  a b c d\n\t\t//      c d\n\t\t//  i = 0; e1 = 1; e2 = -1;\n\n\t\t// \u6EE1\u8DB3\u8FD9\u4E2A\u6761\u4EF6\uFF1A\n\t\t// 1: \u65B0\u503C\u6BD4\u8001\u503C \u77ED \u53EF\u4EE5\u7528 i \u6765\u5224\u65AD , \u6B64\u65F6 i \u5927\u4E8E\u65B0\u503C\u7684\u957F\u5EA6\uFF0C\u5C0F\u4E8E\u8001\u503C\u7684\u957F\u5EA6\n\t\t// 2: \u5FAA\u73AF\u56E0\u5B50 i \u8981\u5728\u65B0\u503C\u7684\u8303\u56F4\u5185\n\t\telse if (i > e2) {\n\t\t\tif (i <= e1) {\n\t\t\t\twhile (i <= e1) {\n\t\t\t\t\tunmount(c1[i]);\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\t// ------- \u4E24\u7AEF\u76F8\u540C\uFF0C\u4E2D\u95F4\u90E8\u4F4D\u4E0D\u540C\u7684vnode \u6BD4\u8F83\n\n\t\t\t//  a b [c d e] f g\n\t\t\t//  a b [e d c h] f g\n\t\t\t// \u4E2D\u95F4\u7684\u4E0D\u540C\n\t\t\t//  i = 2; e1 = 4; e2 = 5;\n\n\t\t\t// \u6B65\u9AA4\uFF1A\n\t\t\t// 1\uFF1A \u7B2C\u4E00\u4E2A\u5148\u904D\u5386\u65B0\u5E8F\u5217\uFF0C\u83B7\u53D6\u5230keyToNewIndexMap\n\t\t\t// 2\uFF1A \u904D\u5386\u8001\u5E8F\u5217\u4ECEkeyToNewIndexMap\u4E2D\u67E5\u627E\u662F\u5426\u6709\u65B0\u5E8F\u5217\u7684\u503C\uFF0C\u5B58\u5728\u5C31\u590D\u7528\uFF0C\u4E0D\u5B58\u5728\u5C31\u5220\u9664\n\n\t\t\tconst s1 = i; // \u8001\u7684 i \u6BD4\u8F83\u7684\u4F4D\u7F6E\n\t\t\tconst s2 = i; // \u65B0\u7684 i \u6BD4\u8F83\u7684\u4F4D\u7F6E\n\n\t\t\t// \u5B58\u50A8\u65B0\u503C\u7684 \u6620\u5C04\uFF0Ckey\u662F vnode\u7684key, value\u662F index\n\t\t\t// {vnode.key: index}\n\t\t\tconst keyToNewIndexMap: Map<string | number | symbol, number> = new Map();\n\n\t\t\t// \u65B0\u5E8F\u5217\u7684\u5FAA\u73AF\n\t\t\tfor (i = s2; i <= e2; i++) {\n\t\t\t\tconst nextChild = (c2[i] = normalizeVNode(c2[i]));\n\n\t\t\t\tif (nextChild.key !== null) {\n\t\t\t\t\tkeyToNewIndexMap.set(nextChild.key, i);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// \u8001\u5E8F\u5217\u5FAA\u73AF\n\t\t\tfor (i = s1; i <= e1; i++) {\n\t\t\t\tconst prevChild = c1[i];\n\t\t\t\t// \u4ECE\u6620\u5C04\u8868\u4E2D\u67E5\u627E\u662F\u5426\u6709 \u5728 \u8001\u7684\u5E8F\u5217\u4E2D \u6709\u65B0\u5E8F\u5217\u7684\u503C\n\t\t\t\tconst newIndex = keyToNewIndexMap.get(prevChild.key);\n\n\t\t\t\t// \u4E0D\u5B58\u5728: \u8BF4\u660E\u65B0\u7684\u91CC\u9762\u6CA1\u6709\uFF0C\u5C31\u8981\u5220\u9664\u8BE5vnode\n\t\t\t\tif (newIndex === undefined) {\n\t\t\t\t\tunmount(prevChild);\n\t\t\t\t} else {\n\t\t\t\t\t// \u5B58\u5728\u5C31\u590D\u7528\u8BE5vnode, \u8FDB\u884Cpatch\n\t\t\t\t\tpatch(prevChild, c2[newIndex] as VNode, container);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// TODO: \u65B0\u5143\u7D20\u7684\u79FB\u52A8\u3001\u63D2\u5165\n\n\t\t\t//  a b [c d e] f g\n\t\t\t//  a b [e d c h] f g\n\n\t\t\tlet patched = 0;\n\t\t\t// \u5C06\u8981\u88ABpatch\u7684\u5143\u7D20\u957F\u5EA6\uFF1A\u5C31\u662F\u4ECEe -> h\n\t\t\tconst toBePatched = e2 - s2 + 1;\n\n\t\t\t// \u8BB0\u5F55\u88AB\u65B0\u5143\u7D20 \u5BF9\u5E94\u8001\u5143\u7D20 \u7684\u4F4D\u7F6E\uFF0C\u9ED8\u8BA4\u521D\u59CB\u5316\u4E3A0\n\t\t\tconst newIndexToOldIndexMap = new Array(toBePatched).fill(0);\n\n\t\t\t// \u5FAA\u73AF\u8001\u5143\u7D20\u5E8F\u5217\n\t\t\tfor (i = s1; i <= e1; i++) {\n\t\t\t\t// \u83B7\u53D6vnode\n\t\t\t\tconst prevChild = c1[i];\n\t\t\t\t// \u65B0\u5143\u7D20\u6BD4\u8001\u5143\u7D20\u5C11\n\n\t\t\t\t//  a b [c d e] f g\n\t\t\t\t//  a b f g\n\t\t\t\tif (patched >= toBePatched) {\n\t\t\t\t\tunmount(prevChild);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * \u603B\u4F53\u6765\u8BF4\u662F\u5B50\u5143\u7D20\u67093\u79CD\u60C5\u51B5\uFF1A\u6587\u672C \u6570\u7EC4 \u7A7A\n\t * \u4E0B\u9762\u53EF\u4EE5\u7EC6\u52069\u79CD\u573A\u666F\n\t * \u6BD4\u5BF9\u5B50\u5143\u7D20\uFF1A \u6709\u4EE5\u4E0B\u51E0\u79CD\u60C5\u51B5\uFF1A\n\t *       \u65B0           \u65E7          diff\n\t * 1:   \u6587\u672C          \u6570\u7EC4        \u5220\u9664\u65E7\u5B50\u5143\u7D20\uFF0C\u8BBE\u7F6E\u65B0\u7684\u6587\u672C\u5185\u5BB9\n\t * 2:   \u6587\u672C          \u6587\u672C        \u66F4\u65B0\u6587\u672C\n\t * 3:   \u6587\u672C          \u7A7A          \u66F4\u65B0\u6587\u672C\n\t * 4:   \u6570\u7EC4          \u6570\u7EC4        diff\n\t * 5:   \u6570\u7EC4          \u6587\u672C        \u6E05\u7A7A\u6587\u672C\uFF0C\u6E32\u67D3\u65B0\u7684\u6570\u7EC4children\n\t * 6:   \u6570\u7EC4          \u7A7A          \u76F4\u63A5\u6E32\u67D3\u6570\u7EC4children\n\t * 7:  \t\u7A7A            \u6570\u7EC4        \u5220\u9664\u6240\u6709\u5B50\u5143\u7D20\n\t * 8:   \u7A7A           \u6587\u672C         \u6E05\u7A7A\u6587\u672C\n\t * 9:   \u7A7A            \u7A7A          \u5FFD\u7565 \u4E0D\u5904\u7406\n\t */\n\tconst patchChildren: PatchChildrenFn = (n1, n2, container, anchor) => {\n\t\t// \u8001\u7684\u5B50\u5143\u7D20\n\t\tconst c1 = n1.children;\n\t\tconst prevShapFlags = n1 ? n1.shapeFlag : 0;\n\n\t\t// \u65B0\u7684\u5B50\u5143\u7D20\n\t\tconst c2 = n2.children;\n\n\t\tconst { shapeFlag } = n2;\n\n\t\t// \u5982\u679C\u65B0children\u662F\u6587\u672C -> \u5BF9\u5E94\u524D\u4E09\u79CD\u60C5\u51B5\n\t\tif (shapeFlag & ShapeFlags.TEXT_CHILDREN) {\n\t\t\t// \u8001\u503C\u662F\u6570\u7EC4 -> \u5BF9\u5E94\u7B2C1\u79CD\u60C5\u51B5\n\t\t\tif (prevShapFlags & ShapeFlags.ARRAY_CHILDREN) {\n\t\t\t\t// \u5220\u9664\u65E7\u7684\u5B50\u5143\u7D20\uFF0C\u8BBE\u7F6E\u65B0\u7684\u6587\u672C\u5185\u5BB9\n\t\t\t\tunmountChildren(c1 as VNode[]);\n\t\t\t}\n\n\t\t\t// \u7B2C\u4E00\u79CD\u60C5\u51B5\uFF0C\u65E7\u503C\u5DF2\u7ECF\u88AB\u5220\u9664\u5B50\u8282\u70B9\u4E86\uFF0C\u5269\u4E0B2\u30013\u76F4\u63A5\u66FF\u6362\u66F4\u65B0\u5373\u53EF\n\t\t\tif (c1 !== c2) {\n\t\t\t\thostSetElementText(container, c2 as string);\n\t\t\t}\n\t\t} else {\n\t\t\t// \u5BF9\u5E94\u540E\u9762\u51E0\u79CD\u60C5\u51B5: \u65B0\u503C\u662F\uFF1A \u6570\u7EC4\uFF0C \u7A7A\n\t\t\tif (prevShapFlags & ShapeFlags.ARRAY_CHILDREN) {\n\t\t\t\tif (shapeFlag & ShapeFlags.ARRAY_CHILDREN) {\n\t\t\t\t\t// \u65B0\u8001\u503C \u90FD\u662F \u6570\u7EC4 -> \u5BF9\u5E94\u7B2C4\u79CD\u60C5\u51B5\n\t\t\t\t\t// \u91CD\u70B9\uFF1A \u5168\u91CF diff\n\t\t\t\t\t// \u8FD9\u91CC\u662F\u60C5\u51B5\u6700\u590D\u6742\u7684\uFF0C\u4E5F\u662F\u6700\u559C\u6B22\u95EE\u8003\u70B9\u7684\uFF1A\n\t\t\t\t\t// 1\uFF1A\u4E3A\u5565\u5FAA\u73AF\u8981\u6307\u5B9Akey\n\t\t\t\t\tpatchKeyedChildren(c1 as VNode[], c2 as VNodeArrayChildren, container);\n\t\t\t\t} else {\n\t\t\t\t\t// \u8FD9\u4E2A\u5206\u652F\u5BF9\u5E94\u7B2C7\u79CD\u60C5\u51B5\uFF0C\u56E0\u4E3A\u7B2C1\u79CD\u60C5\u51B5\u8D70\u4E86\u4E0A\u9762\u7684if\u5206\u652F\n\t\t\t\t\t// \u65B0\u503C\u662F\u7A7A\u7684\uFF0C\u76F4\u63A5\u5378\u8F7D\u8001\u503C\n\t\t\t\t\tunmountChildren(c1 as VNode[]);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// \u8FD9\u4E2A\u52062\u79CD\u60C5\u51B5\uFF1A\u65E7\u503C\u662F\u7A7A\uFF08\u5BF9\u5E94\u7684\u65B0\u503C\u662F\u6587\u672C\u6216\u8005\u662F\u6570\u7EC4\uFF09-> \u5982\u679C\u65B0\u503C\u662F\u6587\u672C\uFF0C\u4F1A\u8D70\u8FDB\u4E00\u4E2Aif\u5224\u65AD\uFF1B \u65B0\u503C\u662F\u6570\u7EC4\uFF0C\u6302\u8F7D\u65B0\u7684\u5143\u7D20\n\t\t\t\t// \u6216\u8005\u65E7\u503C\u662F\u6587\u672C\uFF08\u5BF9\u5E94\u7684\u65B0\u503C\u6587\u672C\u6216\u8005\u662F\u6570\u7EC4\uFF09-> \u5378\u8F7D \u65E7\u7684\u6587\u672C\u5185\u5BB9\uFF0C\u6302\u8F7D\u65B0\u7684\u5143\u7D20\n\n\t\t\t\t// \u5378\u8F7D\u65E7\u7684\u6587\u672C\u5185\u5BB9\n\t\t\t\tif (prevShapFlags & ShapeFlags.TEXT_CHILDREN) {\n\t\t\t\t\t// \u8BBE\u7F6E\u7A7A\u6570\u636E\u5C31\u884C\n\t\t\t\t\thostSetElementText(container, '');\n\t\t\t\t}\n\n\t\t\t\tif (shapeFlag & ShapeFlags.ARRAY_CHILDREN) {\n\t\t\t\t\t// \u6302\u8F7D\u65B0\u7684\u5143\u7D20\n\t\t\t\t\tmountChildren(c2 as VNodeArrayChildren, container, anchor);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\t// \u521D\u6B21\u6E32\u67D3\n\tconst mountElement: MountElementFn = (vnode, container, anchor) => {\n\t\t// \u771F\u5B9E\u8282\u70B9\n\t\tlet el: RendererElement;\n\n\t\tconst { type, shapeFlag, props, children } = vnode;\n\t\t// type ->  div  span .... \u666E\u901A\u5143\u7D20\n\t\tel = vnode.el = hostCreateElement(type as string);\n\n\t\tif (shapeFlag & ShapeFlags.TEXT_CHILDREN) {\n\t\t\t// eg. h('div', props, 'xxx')\n\t\t\thostSetElementText(el, children as string);\n\t\t} else if (shapeFlag & ShapeFlags.ARRAY_CHILDREN) {\n\t\t\t// eg. h('div', props, [h('span', props)])\n\t\t\t// h('div', props, ['xxx', 'ccccc'])\n\t\t\tmountChildren(children as VNodeArrayChildren[], el, null);\n\t\t}\n\n\t\t// \u5904\u7406props\n\t\tif (props) {\n\t\t\tfor (const key in props) {\n\t\t\t\tif (!isReservedProp(key)) {\n\t\t\t\t\thostPatchProp(el, key, null, props[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// \u5728container\u4E0A\u63D2\u5165\u6539\u771F\u5B9E\u8282\u70B9\n\t\thostInsert(el, container, anchor);\n\t};\n\n\t// \u5168\u91CFdiff props\n\t// full diff props\n\tconst patchProps: PatchPropsFn = (el, oldProps, newProps) => {\n\t\t// \u4E0D\u76F8\u7B49\n\t\tif (oldProps !== newProps) {\n\t\t\t// \u8001\u503C\u5B58\u5728\n\t\t\tif (oldProps !== EMPTY_OBJ) {\n\t\t\t\tfor (const key in oldProps) {\n\t\t\t\t\t// \u5224\u65AD\u662F\u5426\u5B58\u5728vue\u4FDD\u7559\u7684key, \u5728\u65B0\u7684props\u4E2D\u4E5F\u4E0D\u5B58\u5728\uFF0C\u9700\u8981\u4FDD\u7559\n\t\t\t\t\tif (!isReservedProp(key) && !(key in newProps)) {\n\t\t\t\t\t\thostPatchProp(el, key, oldProps[key], null);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// \u5B58\u5728\u65B0\u503C\n\t\t\t\tfor (const key in newProps) {\n\t\t\t\t\t// \u5B58\u5728vue\u4FDD\u7559\u7684key\uFF0C \u8DF3\u8FC7\u672C\u6B21\u5FAA\u73AF\uFF0C \u628Apatch\u5EF6\u8FDF\u5728\u6700\u540E\u6267\u884C\uFF0C\u63D0\u5347patch\u6548\u7387\n\t\t\t\t\tif (isReservedProp(key)) continue;\n\t\t\t\t\tconst prev = oldProps[key];\n\t\t\t\t\tconst next = newProps[key];\n\t\t\t\t\t// \u5254\u9664 :value=\"\" v-model:value=\"\"\n\t\t\t\t\tif (prev !== next && key !== 'value') {\n\t\t\t\t\t\thostPatchProp(el, key, prev, next);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// next: {value: ''}  old: {value: ''}\n\t\t\t\tif ('value' in newProps) {\n\t\t\t\t\thostPatchProp(el, 'value', oldProps.value, newProps.value);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\t// diff\n\tconst patchElement: PatchElementFn = (n1, n2) => {\n\t\t// \u5C06\u8001\u7684el\u66FF\u6362\u6210\u65B0\u7684el\n\t\tconst el = (n2.el = n1.el);\n\t\tconst oldProps = n1.props || EMPTY_OBJ;\n\t\tconst newProps = n2.props || EMPTY_OBJ;\n\n\t\t// 1: children\n\t\tpatchChildren(n1, n2, el, null);\n\n\t\t// 2: props\n\t\t// TODO: \u8FD9\u91CC\u53EF\u4EE5\u6839\u636E \u7F16\u8BD1\u9636\u6BB5 \u8BBE\u7F6E patchFlag \u6765\u5224\u65AD\u662F\u66F4\u65B0class style props\u3001\u52A8\u6001props\n\t\t// \u8FD9\u91CC\u5148\u5168\u91CFdiff props, \u540E\u7EED\u7F16\u8BD1\u9636\u6BB5\u53EF\u4EE5\u7ED3\u5408\u8D77\u6765 \u5224\u65AD patchFlag\n\t\tpatchProps(el, oldProps, newProps);\n\t};\n\n\tconst processElement: ProcessElementFn = (n1, n2, container, anchor) => {\n\t\tif (n1 == null) {\n\t\t\t// \u521D\u6B21\u6E32\u67D3\n\t\t\tmountElement(n2, container, anchor);\n\t\t} else {\n\t\t\t// diff\n\t\t\tpatchElement(n1, n2);\n\t\t}\n\t};\n\n\tconst processText: ProcessTextFn = (n1, n2, el, anchor) => {\n\t\tif (n1 === null) {\n\t\t\t// \u6302\u8F7D\n\t\t\thostInsert((n2.el = hostCreateText(n2.children as string)), el, anchor);\n\t\t} else {\n\t\t\t// \u66F4\u65B0\n\t\t\tconst el = (n2.el = n1.el);\n\t\t\tif (n2.children !== n1.children) {\n\t\t\t\thostSetText(el, n2.children as string);\n\t\t\t}\n\t\t}\n\t};\n\n\tconst processComment: ProcessCommentFn = (n1, n2, container, anchor) => {\n\t\tif (n1 === null) {\n\t\t\thostInsert((n2.el = hostCreateComment((n2.children as string) || '')), container, anchor);\n\t\t} else {\n\t\t\tn2.el = n1.el;\n\t\t\t// \u4E0D\u652F\u6301\u52A8\u6001 \u6CE8\u91CA\u8282\u70B9\n\t\t}\n\t};\n\n\tconst processFragment = (n1: VNode | null, n2: VNode, container: RendererElement, anchor: RendererNode | null) => {\n\t\t// \u5982\u679C\u662F\u7B2C\u4E00\u6B21\u6E32\u67D3\uFF0Cn2.el \u9ED8\u8BA4\u662F\u521B\u5EFA\u4E00\u4E2Atext\u6587\u672C\n\t\t// patch\u66F4\u65B0\u65F6\uFF1An2.el = n1\n\t\tconst fragmentStartAnchor = (n2.el = n1 ? n1.el : hostCreateText(''))!;\n\t\tconst fragmentEndAnchor = (n2.anchor = n1 ? n1.anchor : hostCreateText(''))!;\n\t\tif (n1 === null) {\n\t\t\t// \u7236\u5143\u7D20\u9ED8\u8BA4\u662F\u7A7A\u6587\u672C\n\t\t\thostInsert(fragmentStartAnchor, container, anchor);\n\t\t\thostInsert(fragmentEndAnchor, container, anchor);\n\n\t\t\t// fragmnet \u5B50\u5143\u7D20\u5FC5\u987B\u662Fchildren\n\t\t\tmountChildren(n2.children as VNodeArrayChildren, container, fragmentEndAnchor);\n\t\t} else {\n\t\t\t// patch\n\t\t\tpatchChildren(n1, n2, container, fragmentEndAnchor);\n\t\t}\n\t};\n\n\tconst processComponent: ProcessComponentFn = (n1, n2, container, anchor, parentComponent) => {\n\t\tif (n1 === null) {\n\t\t\tmountComponent(n2, container, anchor, parentComponent);\n\t\t} else {\n\t\t\tupdateComponent();\n\t\t}\n\t};\n\n\t// \u91CD\u70B9: \u7EC4\u4EF6\u5173\u8054effect\n\t// \u7EC4\u88C5\u54CD\u5E94\u5F0F\u6570\u636E\uFF0C\u7ED1\u5B9Aeffect\n\tconst setupRenderEffect: SetupRenderEffectFn = (instance, initialVNode, container, anchor) => {\n\t\t// \u9ED8\u8BA4\u4F1A\u6267\u884C\u4E00\u6B21\u53D1\u65B9\u6CD5\n\t\tconst componentUpdateFn = () => {\n\t\t\t// \u7B2C\u4E00\u6B21\u6267\u884C\n\t\t\tif (!instance.isMounted) {\n\t\t\t\t// 1. \u6E32\u67D3\u7EC4\u4EF6\u5185\u5BB9\n\t\t\t\tconst subTree = (instance.subTree = renderComponentRoot(instance));\n\t\t\t\t// patch children\n\t\t\t\tpatch(null, subTree, container, anchor, instance);\n\n\t\t\t\t// \u4FDD\u5B58\u771F\u5B9Edom\u8282\u70B9\n\t\t\t\tinitialVNode.el = subTree.el;\n\n\t\t\t\t// 2. \u6302\u8F7D\u7EC4\u4EF6\u6210\u529F\n\t\t\t\tinstance.isMounted = true;\n\t\t\t} else {\n\t\t\t\t// \u5F53\u7EC4\u4EF6\u5185\u90E8\u7684\u54CD\u5E94\u5F0F\u6570\u636E\u53D1\u751F\u53D8\u5316\u65F6\uFF0C\u6267\u884C\n\t\t\t}\n\t\t};\n\t\t// \u91CD\u70B9: \u521B\u5EFAeffect\n\t\tconst effect = (instance.effect = new ReactiveEffect(componentUpdateFn, () => {}));\n\n\t\tconst update: SchedulerJob = (instance.update = () => effect.run());\n\n\t\t// \u6807\u8BB0\u4E0Bjob id \u8DDF\u7EC4\u4EF6uid\u5173\u8054\n\t\tupdate.id = instance.uid;\n\n\t\t// \u9ED8\u8BA4\u6267\u884C\u4E00\u6B21\n\t\tupdate();\n\t};\n\n\t// \u521D\u6B21\u6302\u8F7D\u7EC4\u4EF6\n\tconst mountComponent = (\n\t\tinitialVNode: VNode,\n\t\tcontainer: RendererElement,\n\t\tanchor: RendererNode | null,\n\t\tparentComponent: ComponentInternalInstance\n\t) => {\n\t\tconst instance = createComponentInstance(initialVNode, parentComponent);\n\n\t\tsetupComponent(instance);\n\n\t\tsetupRenderEffect(instance, initialVNode, container, anchor);\n\t};\n\n\t// \u7EC4\u4EF6\u7684props\u53D8\u66F4\u5BFC\u81F4\u7EC4\u4EF6\u66F4\u65B0\n\tconst updateComponent = () => {};\n\n\tconst patch: PatchFn = (n1, n2, container, anchor = null, parentComponent) => {\n\t\t// \u76F8\u540C\u7684\u8282\u70B9\uFF0C\u76F4\u63A5\u8FD4\u56DE\n\t\tif (n1 === n2) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (n1 && !isSameVNodeType(n1, n2)) {\n\t\t\t// \u83B7\u53D6\u8001\u8282\u70B9\u76F8\u90BB\u7684\u8282\u70B9\n\t\t\tanchor = getNextHostNode(n1);\n\t\t\t// \u5B58\u5728\u8001\u8282\u70B9\uFF0C\u5E76\u4E14\u65B0\u8282\u70B9\u548C\u8001\u8282\u70B9\u4E0D\u4E00\u6837\uFF0C\u5378\u8F7D\u8001\u8282\u70B9\n\n\t\t\tunmount(n1);\n\n\t\t\t// \u5220\u9664n1, \u4EE3\u8868\u4E3A\u521D\u6B21\u6E32\u67D3\n\t\t\tn1 = null;\n\t\t}\n\t\tconst { type, shapeFlag } = n2;\n\n\t\tswitch (type) {\n\t\t\tcase Text:\n\t\t\t\tprocessText(n1, n2, container, anchor);\n\t\t\t\tbreak;\n\t\t\tcase Comment:\n\t\t\t\tprocessComment(n1, n2, container, anchor);\n\t\t\t\tbreak;\n\t\t\tcase Fragment:\n\t\t\t\tprocessFragment(n1, n2, container, anchor);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\t// \u8FD9\u91CC\u5148\u5904\u7406\u666E\u901A\u5143\u7D20 div  span ul\n\t\t\t\tif (shapeFlag & ShapeFlags.ELEMENT) {\n\t\t\t\t\t// \u666E\u901A\u5143\u7D20\n\t\t\t\t\tprocessElement(n1, n2, container, anchor);\n\t\t\t\t} else if (shapeFlag & ShapeFlags.COMPONENT) {\n\t\t\t\t\t// \u7EC4\u4EF6\n\t\t\t\t\tprocessComponent(n1, n2, container, anchor, parentComponent);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t};\n\n\t// \u5220\u9664\u5143\u7D20\n\tconst unmount: UnmountFn = vnode => {\n\t\tremove(vnode);\n\t};\n\n\tconst remove: RemoveFn = vnode => {\n\t\t// \u4FDD\u6301\u8DDF\u6E90\u7801\u4E00\u81F4\n\t\tperformRemove(vnode);\n\t};\n\n\tconst performRemove = (vnode: VNode) => {\n\t\tconst { el } = vnode;\n\t\thostRemove(el);\n\t};\n\n\tconst getNextHostNode: NextFn = vnode => {\n\t\tif (vnode.shapeFlag & ShapeFlags.COMPONENT) {\n\t\t\t// \u7EC4\u4EF6\n\t\t\t// TODO:\u83B7\u53D6\u76F8\u90BB\u7684\u7EC4\u4EF6\n\t\t}\n\t\treturn hostNextSibling(vnode.anchor || vnode.el);\n\t};\n\n\tconst render: RootRenderFunction = (vnode, container) => {\n\t\tif (vnode == null) {\n\t\t\t// \u6CA1\u6709\u65B0\u8282\u70B9 \u4F46\u662F\u6709\u65E7\u7684\u8282\u70B9\uFF0C\u8981\u5220\u9664 \u5378\u8F7D\u6389\n\t\t\tif (container._vnode) {\n\t\t\t\tunmount(container._vnode);\n\t\t\t}\n\t\t} else {\n\t\t\tpatch(container._vnode || null, vnode, container, null, null);\n\t\t}\n\t\t// \u4FDD\u5B58\u8001\u8282\u70B9\n\t\tcontainer._vnode = vnode;\n\t};\n\treturn {\n\t\trender\n\t};\n}\n", "import { isArray, isObject } from '@vue/shared';\nimport { VNode, createVNode, isVNode } from './vnode';\n\n// h\u51FD\u6570\u6709\u4EE5\u4E0B\u51E0\u79CD\u4F20\u5165\u65B9\u5F0F\n\n// \u7EAF\u6587\u672C\n// h('div')\n\n//  type + \u5C5E\u6027\n// h('div', {})\n\n// type + children\n// h('div', [])\n// h('div', 'text')\n// h('div', h('span'))\n\n// type + \u5C5E\u6027 + children\n// h('div', {}, '')\n// h('div', {}, h('span'))   // vnode children\n// h('div', {}, [''])        // \u6570\u7EC4\u6587\u672Cchildren\n// h('div', {}, [h('span')]) // \u6570\u7EC4 vnode children\n\n// Components\n// h(Components, () => {}) default slots\n// h(Component, {}, () => {}) // default slot\n// h(Component, {}, {}) // named slots\n\nexport function h(type: any, propsOrChildren?: any, children?: any, ..._: any[]): VNode {\n\t// \u5224\u65AD\u53C2\u6570\u957F\u5EA6\n\n\tconst l = arguments.length;\n\n\t// type\u662F\u4E00\u5B9A\u6709\u7684\n\tif (l === 2) {\n\t\t// \u53C2\u6570\u4E3A2\u4E2A\uFF0C\u7B2C\u4E8C\u4E2A\u53C2\u6570 \u6709\u53EF\u80FD\u662Fchildren (\u6587\u672C\u3001vnode), \u4E5F\u6709\u53EF\u80FD\u662Fprops\n\t\t// children:  h('div', '')  h('div', [])\n\t\t// props: h('div', {})\n\t\tif (isObject(propsOrChildren) && !isArray(propsOrChildren)) {\n\t\t\t// \u7B2C\u4E8C\u4E2A\u53C2\u6570\u662F vnode\n\t\t\t// h('div', h('span'))\n\t\t\tif (isVNode(propsOrChildren)) {\n\t\t\t\treturn createVNode(type, null, [propsOrChildren]);\n\t\t\t}\n\t\t\t// \u7B2C\u4E8C\u4E2A\u53C2\u6570\u662F\u5C5E\u6027\n\t\t\t// h('div', {})\n\t\t\treturn createVNode(type, propsOrChildren);\n\t\t} else {\n\t\t\t// \u7B2C\u4E8C\u4E2A\u53C2\u6570\u662Fchildren\n\t\t\t// h('div', 'xxx')\n\t\t\treturn createVNode(type, null, propsOrChildren);\n\t\t}\n\t} else {\n\t\t// 3\u79CD\u60C5\u51B5\n\t\t// h('div')\n\t\t// h('div', {}, '')\n\t\t// h('div', {}, '', '')\n\n\t\tif (l > 3) {\n\t\t\t// h('div', {}, '', '')\n\t\t\t// \u53D6\u540E\u4E24\u4E2A\uFF0C\u591A\u4F59\u7684\u53C2\u6570\u90FD\u8F6C\u6210\u6570\u7EC4\n\t\t\tchildren = Array.prototype.slice.call(arguments, 2);\n\t\t} else if (l === 3 && isVNode(children)) {\n\t\t\t// h('div', {}, h('span'))\n\t\t\tchildren = [children];\n\t\t}\n\t\treturn createVNode(type, propsOrChildren, children);\n\t}\n}\n", "import { RendererOptions } from '@vue/runtime-core';\n\n// \u589E\u5220\u6539\u67E5\nexport const nodeOps: Omit<RendererOptions<Node, Element>, 'patchProp'> = {\n\t// \u589E\u52A0\u3001\u63D2\u5165\n\tinsert(child, parent, anchor) {\n\t\tparent.insertBefore(child, anchor || null);\n\t},\n\t// \u5220\u9664\n\tremove(child) {\n\t\tconst parent = child.parentNode;\n\t\tif (parent) {\n\t\t\tparent.removeChild(child);\n\t\t}\n\t},\n\tcreateElement(tagName) {\n\t\treturn document.createElement(tagName);\n\t},\n\tcreateText(text: string) {\n\t\treturn document.createTextNode(text);\n\t},\n\tcreateComment(data) {\n\t\treturn document.createComment(data);\n\t},\n\tsetText(el, text) {\n\t\tel.nodeValue = text;\n\t},\n\tsetElementText(el, text) {\n\t\tel.textContent = text;\n\t},\n\tparentNode(node) {\n\t\treturn node.parentNode as Element;\n\t},\n\tnextSibling(node) {\n\t\treturn node.nextSibling;\n\t},\n\tquertSelector(selector) {\n\t\treturn document.querySelector(selector);\n\t}\n};\n", "import { isNoEmptyValue } from '@vue/shared';\n\nexport function patchClass(el: Element, value: string) {\n\tif (isNoEmptyValue(value)) {\n\t\t// \u76F4\u63A5\u8986\u76D6\n\t\tel.className = value;\n\t} else {\n\t\t// \u5220\u9664class\u5C5E\u6027\n\t\tel.removeAttribute('class');\n\t}\n}\n", "import { isString } from '@vue/shared';\n\ntype Style = string | Record<string, string | string[]> | null;\n\nexport function patchStyle(el: Element, prev: Style, next: Style) {\n\tconst style = (el as HTMLElement).style;\n\tconst isCssString = isString(next);\n\tconst isPrevCssString = isString(prev);\n\n\t// eg. <div :style={}></div> style\u662F\u4E2A\u5BF9\u8C61\n\n\t// \u5B58\u5728\u65B0\u503C\uFF0C\u5E76\u4E14\u662F\u5BF9\u8C61\n\tif (next && !isCssString) {\n\t\tif (prev && !isPrevCssString) {\n\t\t\t// \u8BF4\u660E\u8001\u503C \u548C\u65B0\u503C\u90FD\u662F\u5BF9\u8C61\n\t\t\tfor (const key in prev) {\n\t\t\t\t// \u8001\u503C \u5728\u65B0\u7684\u503C\u91CC\u9762\u6CA1\u6709\uFF0C\u5220\u9664\u8001\u503C\n\t\t\t\tif (next[key] == null) {\n\t\t\t\t\tstyle[key] = '';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// \u8BBE\u7F6E\u65B0\u7684\u503C\n\t\tfor (const key in next) {\n\t\t\tstyle[key] = next[key];\n\t\t}\n\t} else {\n\t\t// eg. <div style=\"\"></div>\n\t\t// \u65B0\u503C\u662Fstring\n\t\tif (isCssString) {\n\t\t\t// \u6BD4\u8F83\u4E0B\u662F\u5426\u76F8\u7B49\n\t\t\tif (prev != next) {\n\t\t\t\tstyle.cssText = next;\n\t\t\t}\n\t\t} else if (prev) {\n\t\t\t// \u65B0\u503C\u662Fnull\uFF0C\u800C\u4E14\u5B58\u5728\u8001\u503C\uFF0C\u5220\u6389\u8001\u503C\n\t\t\tel.removeAttribute('style');\n\t\t}\n\t}\n}\n", "// \u4E8B\u4EF6fn\u7684\u7C7B\u578B\ntype EventValue = Function | ((e: Event) => void);\n\n// invoker.value = fn\nexport interface Invoker extends EventListener {\n\tvalue: EventValue;\n}\n\n// invoker \u8BB0\u5F55\u4E8B\u4EF6\u7684\u5BF9\u8C61\uFF0C\u5176value\u5C5E\u6027\u4FDD\u5B58\u7740\u5BF9\u7528\u6237\u4E8B\u4EF6\u7684\u5F15\u7528\uFF0C\n// \u5F53\u65B0\u7684\u503C\u8FC7\u6765\uFF0C \u53EA\u9700\u8981\u66FF\u6362value\u5C5E\u6027\u5373\u523B\n\nexport function patchEvent(\n\tel: Element & { _vei?: Record<string, Invoker | undefined> },\n\tkey: string,\n\tnextValue: EventValue | null\n) {\n\t// \u53BB\u6389on, \u4E8B\u4EF6\u540D\u79F0\u8F6C\u5C0F\u5199\n\t// onXxxx -> xxxx\n\tconst name = key.slice(2).toLowerCase();\n\n\t// _vei = vue event invokers \u7ED9element\u5143\u7D20\u6269\u5C55\u4E00\u4E2A_vei\u5BF9\u8C61\uFF0C\u5176\u4F5C\u7528\u5C31\u662F\u6682\u5B58invokers\n\t// \u6BCF\u5F53\u6709\u65B0\u7684fn\u8FDB\u6765\uFF0C\u5C31\u4F1A\u5148\u4ECE\u5143\u7D20\u4E0A\u53D6\u4E00\u904Dinvokers\uFF0C\u6CA1\u6709\u7684\u8BDD\u521B\u5EFA\u4E00\u4E2A\u65B0\u7684\n\t// \u6570\u636E\u7ED3\u6784\u5982\u4E0B\uFF1A\n\t// _vei = invokers = {\u4E8B\u4EF6\u540D\u79F0: invoker = fn}\n\t// fn\u51FD\u6570\u4E0A\u6709value\u5C5E\u6027 \u6620\u5C04\u7684\u662Ffn\u672C\u8EAB\n\tconst invokers = el._vei || (el._vei = {});\n\n\t// \u83B7\u53D6\u7F13\u5B58\u7684invokers\n\tconst existingInvoker = invokers[name];\n\n\t// \u5B58\u5728\u65B0\u503C \u4E5F\u5B58\u5728\u8001\u503C\n\tif (nextValue && existingInvoker) {\n\t\t// \u66FF\u6362\u8001\u503C\n\t\texistingInvoker.value = nextValue;\n\t} else {\n\t\t// \u6709\u53EF\u80FD\u65B0\u503C\u6CA1\u6709\uFF0C\u4E5F\u6709\u53EF\u80FD\u8001\u503C\u6CA1\u6709\n\n\t\tif (nextValue) {\n\t\t\t// \u5B58\u5728\u65B0\u503C\uFF0C\u4E0D\u5B58\u5728\u8001\u503C\n\t\t\t// \u8BBE\u7F6E\u65B0\u503C\u7684\u4E8B\u4EF6\u76D1\u542C\uFF0C \u7F13\u5B58invokers\n\t\t\tconst invoker = (invokers[name] = createInvoker(nextValue));\n\n\t\t\t// \u8BBE\u7F6E\u4E8B\u4EF6\u76D1\u542C\n\t\t\tel.addEventListener(name, invoker);\n\t\t} else if (existingInvoker) {\n\t\t\t// \u65B0\u503C\u662F\u6CA1\u6709\u7684\uFF0C\u4F46\u662F\u5B58\u5728\u8001\u503C\uFF0C\u610F\u5473\u7740\u8FD9\u6B21\u66F4\u65B0\uFF0Cfn\u4F20\u5165\u4E86null\uFF0C\u5C31\u9700\u8981\u79FB\u9664\u6389\u8001\u503C\u4E8B\u4EF6\n\t\t\tel.removeEventListener(name, existingInvoker);\n\t\t\t// \u5220\u9664\u7F13\u5B58\u7684invoker\n\t\t\tinvokers[name] = null;\n\t\t}\n\t}\n}\n\n/**\n *  invoker = fn\n * \tinvoker.value = invoker\n *\n * \tinvoker.value === invoker  true\n */\nfunction createInvoker(initialValue: EventValue): Invoker {\n\t// \u521B\u5EFA\u4E00\u4E2A\u65B0\u7684invoker\u51FD\u6570\uFF0C \u5F53invoker\u6267\u884C\u7684\u65F6\u5019\uFF0C\u5C31\u662F\u6267\u884CinitialValue\u51FD\u6570\n\t// invoker.value === initialValue  true\n\tconst invoker: Invoker = (e: Event) => invoker.value(e);\n\t// \u8BBE\u7F6E\u65B0\u503C\n\tinvoker.value = initialValue;\n\treturn invoker;\n}\n", "import { isNoEmptyValue } from '@vue/shared';\n\nexport function patchAttrs(el: Element, key: string, nextValue: any) {\n\tif (isNoEmptyValue(nextValue)) {\n\t\tel.setAttribute(key, nextValue);\n\t} else {\n\t\tel.removeAttribute(key);\n\t}\n}\n", "// \u8BBE\u7F6E\u5143\u7D20\u7684\u5C5E\u6027 class  style props event\n\nimport { RendererOptions } from '@vue/runtime-core';\nimport { patchClass } from './modules/class';\nimport { patchStyle } from './modules/style';\nimport { isOn } from '@vue/shared';\nimport { patchEvent } from './modules/events';\nimport { patchAttrs } from './modules/attrs';\n\nexport const patchProp: RendererOptions['patchProp'] = (el: Element, key: string, preValue: any, nextValue: any) => {\n\t// TODO: patchProp\n\tif (key === 'class') {\n\t\tpatchClass(el, nextValue);\n\t} else if (key === 'style') {\n\t\tpatchStyle(el, preValue, nextValue);\n\t} else if (isOn(key)) {\n\t\tpatchEvent(el, key, nextValue);\n\t} else {\n\t\tpatchAttrs(el, key, nextValue);\n\t}\n};\n", "import { extend } from '@vue/shared';\nimport { nodeOps } from './nodeOps';\nimport { patchProp } from './patchProp';\nimport { Renderer, RootRenderFunction, createRenderer } from '@vue/runtime-core';\n\nconst rendererOptions = extend(nodeOps, { patchProp });\n\nlet renderer: Renderer<Element | ShadowRoot>;\n\n// \u61D2\u52A0\u8F7D\nfunction ensureRenderer() {\n\treturn renderer || (renderer = createRenderer(rendererOptions));\n}\n\nexport const render = ((...args) => {\n\tensureRenderer().render(...args);\n}) as RootRenderFunction<ShadowRoot>;\n\nexport * from '@vue/runtime-core';\n"],
  "mappings": "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",
  "names": ["Comment", "render", "set", "isReadonly", "get", "isReadonly", "el", "Comment", "render"]
}
